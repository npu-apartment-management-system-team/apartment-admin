import{r,j as e,R as Ye}from"./react-405f76d8.js";import{c as ut}from"./react-dom-04773658.js";import{B as mt}from"./react-router-dom-d8ab318c.js";import{a as we}from"./axios-4a70c6fc.js";import{q as pt}from"./qs-b3e11d6e.js";import{J as ht}from"./js-encrypt-af0330d8.js";import{m as ve,I as re,T as Ze,B as U,M as xt,a as et,S as Be,b as ne,c as We,d as ft,e as jt,D as de,R as B,f as Se,C as b,g as gt,U as yt,L as Z,h as he,H as xe,i as fe,j as Pe}from"./antd-2c2e5a9c.js";import{U as tt,O as It,Q as qe,m as Ge,T as bt,V}from"./@ant-design-d7eb546f.js";import{u as Qe,a as ce,b as E,N as ue}from"./react-router-345db1d8.js";import{P as me}from"./pubsub-js-cf81b55e.js";import{v as ie}from"./uuid-a960c1f4.js";import{O as St}from"./ali-oss-9a2253aa.js";import{s as He}from"./store-10531bb0.js";import"./scheduler-765c72db.js";import"./@remix-run-93d98c9a.js";import"./side-channel-86ee5d5c.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-e5c1c8b0.js";import"./object-inspect-2b0f847f.js";import"./rc-util-850552fb.js";import"./@babel-5495bcd4.js";import"./react-is-e8e5dbb3.js";import"./classnames-423472b7.js";import"./rc-resize-observer-c1f7585f.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-motion-3201de9c.js";import"./rc-tabs-0d77b2d0.js";import"./rc-dropdown-708b9c2c.js";import"./@rc-component-936e731d.js";import"./rc-menu-37d51047.js";import"./rc-overflow-ddb4f90e.js";import"./rc-select-cf6958bf.js";import"./rc-virtual-list-ae0a1e4e.js";import"./rc-drawer-99af170c.js";import"./rc-field-form-54e4fc4e.js";import"./async-validator-7f96df71.js";import"./rc-dialog-a74ba1f8.js";import"./rc-notification-74a1f2ae.js";import"./rc-table-cd631858.js";import"./throttle-debounce-87e7e444.js";import"./rc-checkbox-91ed4fc8.js";import"./rc-tree-40c741fd.js";import"./@ctrl-fb5a5473.js";import"./rc-pagination-a2446b27.js";import"./rc-input-bb537b4e.js";import"./rc-textarea-e23bd29b.js";import"./rc-upload-69a575d0.js";import"./rc-picker-33c36620.js";import"./rc-progress-408c3afa.js";import"./rc-tooltip-adb341bc.js";import"./@emotion-c0b5c018.js";import"./stylis-fad5b415.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))y(n);new MutationObserver(n=>{for(const j of n)if(j.type==="childList")for(const w of j.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&y(w)}).observe(document,{childList:!0,subtree:!0});function h(n){const j={};return n.integrity&&(j.integrity=n.integrity),n.referrerPolicy&&(j.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?j.credentials="include":n.crossOrigin==="anonymous"?j.credentials="omit":j.credentials="same-origin",j}function y(n){if(n.ep)return;n.ep=!0;const j=h(n);fetch(n.href,j)}})();const L=we.create({baseURL:"https://apartment-server.wangminan.me",paramsSerializer:s=>pt.stringify(s,{arrayFormat:"brackets"})});L.interceptors.request.use(s=>(window.localStorage.getItem("token")!==void 0&&(s.headers.Authorization="Bearer "+window.localStorage.getItem("token")),s),s=>Promise.reject(s));L.interceptors.response.use(s=>(s!==null&&s.data!==null&&s.data.code!==null&&(s.data.code===4012||s.data.code===4010||s.data.code===4030)&&(window.localStorage.removeItem("token"),setTimeout(()=>{window.location.href="/login"},3e3)),s),s=>Promise.reject(s));const wt=`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5vwYRBKySNSl/60qRqcD
lDVcNP9j2UyB7yalGI9MtlBEZ16pEiR08TuZjUL00go5LEb6z+ghVlp6UOsWR6i3
r7Q+FleKHG2yStqqaWx+11OQzOjffXQwqb1t/0bq/tzy04KBinSaB/yqnMc0yO8n
rZx8OtUX5rMcM7BjvpFOdnCSFUAOOfKRirfT5RydyGeLPOnBTwJIwpygGu20++UX
MxARO1aAJeUXeI+9g+XcsAi1EKbI2YdjWJ8PQnBC9+lsDRS3w8uKqUOZdYu/FxAy
bEjQ+YOXzfu2PB9+BdilkztV/yuF6hfk7MpGdA2JoBsJlljSYWH1mUE+e9mnUyHi
/wIDAQAB`;function Ct(s){const u=new ht;return u.setPublicKey(wt),u.encrypt(s)}function kt(s){const u="13777864454",h="root",[y,n]=r.useState(u),[j,w]=r.useState(h),[v,a]=r.useState(!1),[S,F]=ve.useMessage();function c(x){n(()=>x.target.value)}function T(x){w(()=>x.target.value)}function o(){a(!0),L({method:"POST",url:"/api/auth/login/password",data:{username:y,password:Ct(j)}}).then(x=>{const{code:g,result:l}=x.data;if(g===2e3)if(window.localStorage.setItem("token",l.token),window.localStorage.setItem("role",l.role),l.user)l.user,s.login(l.role,l.user);else{const f=l.admin;window.localStorage.setItem("user.id",f.id),window.localStorage.setItem("user.name",f.name),window.localStorage.setItem("user.loginAccountId",f.loginAccountId),window.localStorage.setItem("user.email",f.email),s.login(l.role,l.admin)}else{const{msg:f}=x.data;w(""),S.info(f)}a(!1)})}return e.jsxs("div",{children:[F,e.jsx(re,{value:y,onChange:c,placeholder:"Enter your username",prefix:e.jsx(tt,{className:"site-form-item-icon"}),suffix:e.jsx(Ze,{title:"Extra information",children:e.jsx(It,{style:{color:"rgba(0,0,0,.45)"}})})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(re.Password,{value:j,onChange:T,placeholder:"input password",iconRender:x=>x?e.jsx(qe,{}):e.jsx(Ge,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(U,{size:"large",type:"primary",loading:v,onClick:o,children:"Login"})]})}function vt(){const[s,u]=r.useState(""),[h,y]=r.useState(""),[n,j]=r.useState(""),[w,v]=r.useState("");function a(o){u(()=>o.target.value)}function S(o,x){v(x!==""&&o!==x?()=>"error":()=>"")}function F(o){y(()=>o.target.value),S(o.target.value,n)}function c(o){j(()=>o.target.value),S(h,o.target.value)}function T(o){h!==n&&alert("")}return e.jsxs("div",{children:[e.jsx(re,{onChange:a,placeholder:"default size",prefix:e.jsx(tt,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(re.Password,{onChange:F,placeholder:"input password",iconRender:o=>o?e.jsx(qe,{}):e.jsx(Ge,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(re.Password,{status:w,onChange:c,placeholder:"password again",iconRender:o=>o?e.jsx(qe,{}):e.jsx(Ge,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(U,{size:"large",type:"primary",onClick:T,children:"SignUP"})]})}const Tt=""+new URL("apartment-d819f74c.svg",import.meta.url).href;function je(s){const{routers:u}=s,h=Qe();function y(n){h("/home"+u[parseInt(n.key,10)-1].route,{replace:!0})}return e.jsx("div",{children:e.jsx("div",{children:e.jsx(xt,{mode:s.mode,theme:s.theme,items:s.textitem,onClick:y})})})}function ge(s){return e.jsx(Ze,{placement:"right",title:"先生/女士",children:e.jsxs("span",{children:["欢迎您，",s.job," ",s.usermsg]})})}function Ut(s){const{tableitems:u,openAddDrawer:h,tabletype:y,addMsg:n,addfun:j}=s,[w,v]=r.useState(!1),[a,S]=r.useState(!1),[F,c]=r.useState("请在下方补全需要添加的条目 "),T=()=>{c(g=>g+n),h(),v(!0)},o=()=>{S(!0),j(),S(!1)},x=()=>{v(!1)};return e.jsxs("div",{children:[e.jsx(U,{type:"primary",onClick:T,children:"增加条目"}),e.jsxs(et,{title:y,open:w,onOk:o,okText:"提交",confirmLoading:a,onCancel:x,cancelText:"关闭",children:[e.jsx("p",{children:F}),u]})]})}function Oe(s){const{checkonly:u}=s,{tableitems:h,openAddDrawer:y,addMsg:n,addfun:j}=s,{getApart:w,getRoom:v,getBed:a,getOutPay:S}=s;let{tabletype:F,columns:c,tabledata:T,tablepage:o,tabletitle:x}=s;const[g,l]=r.useState(!1);me.subscribe("tablereturned",(k,K)=>{l(()=>K)});const[,f]=Ye.useState(),A=Ye.useCallback(()=>f({}),[]);return r.useEffect(()=>{F==="apart"?(l(!1),w(1,100),A()):F==="room"?(l(!1),v(1,100),A()):F==="bed"?(l(!1),a(1,100)):F==="outpay"&&(l(!1),S(1,100))},[F]),g?u?e.jsx("div",{children:e.jsxs(ne,{direction:"vertical",size:16,children:[e.jsx("h2",{children:x}),e.jsx(We,{columns:c,dataSource:T,pagination:!1})]})}):(me.subscribe("tablepage",(k,K)=>{o=K}),e.jsx("div",{children:e.jsxs(ne,{direction:"vertical",size:16,children:[e.jsx("h2",{children:x}),e.jsx(Ut,{openAddDrawer:y,tableitems:h,tabletype:F,addMsg:n,addfun:j}),e.jsx(We,{columns:c,dataSource:T,pagination:!1})]})})):e.jsx("div",{children:e.jsx(Be,{})})}function At(s){const{type:u,transdata:h,send:y}=s,[n,j]=r.useState([]),[w,v]=r.useState([]),[a,S]=r.useState("");function F(){let g=[];for(let l=0;l<n.length;l++)for(let f=0;f<h.length;f++)n[l]===h[f].key&&g.push(h[f].id);y(g,a,u),S("")}function c(g){S(g.target.value)}const T=(g,l,f)=>{j(g)},o=(g,l)=>{v([...g,...l])},x=(g,l)=>{};return e.jsxs("div",{className:"transferbox",children:[e.jsx("div",{children:e.jsx(ft,{dataSource:h,titles:["用户列表","发送给"],targetKeys:n,selectedKeys:w,onChange:T,onSelectChange:o,onScroll:x,render:g=>g.title})}),e.jsx(jt,{showCount:!0,maxLength:4096,style:{height:120,resize:"none"},onChange:c,placeholder:"请在此键入发信内容",value:a}),e.jsx(U,{onClick:F,children:"发送"})]})}function Pt(s){const[u,h]=r.useState([]),[y,n]=r.useState([]),{lognum:j,userid:w}=s,[v,a]=ve.useMessage();r.useEffect(()=>{we.defaults.baseURL="https://apartment-server.wangminan.me",F(1,100),c(1,100)},[]);function S(T,o,x){x==="user"?L({method:"POST",url:"/api/message/sender/send",data:{senderAdminId:w,receiverAdminIds:[],receiverUserIds:T,message:o}}).then(g=>{const{code:l,msg:f}=g.data;l===2e3?v.info("发送成功"):v.info(f)}):x==="admin"?L({method:"POST",url:"/api/message/sender/send",data:{senderAdminId:w,receiverAdminIds:T,receiverUserIds:[],message:o}}).then(g=>{const{code:l,msg:f}=g.data;l===2e3?v.info("发送成功"):v.info(f)}):v.info("发送对象非法")}function F(T,o){L({method:"GET",url:`/api/user/user?pageNum=${T}&pageSize=${o}`}).then(x=>{const{code:g}=x.data;if(g===2e3){const{list:l}=x.data.result;let f=[];for(let A=0;A<l.length;A++){let k={};k.key=ie(),k.title=l[A].name,k.name=l[A].name,k.id=l[A].id,k.loginAccountId=l[A].loginAccountId,k.personalId=l[A].personalId,f.push(k)}h(f)}else{const{msg:l}=x.data;v.info(l)}})}function c(T,o){L({method:"GET",url:`/api/user/admin?pageNum=${T}&pageSize=${o}`}).then(x=>{const{code:g}=x.data;if(g===2e3){const{list:l}=x.data.result;let f=[];for(let A=0;A<l.length;A++){let k={};k.key=ie(),k.title=l[A].name,k.name=l[A].name,k.id=l[A].id,k.loginAccountId=l[A].loginAccountId,k.departmentId=l[A].departmentId,k.email=l[A].email,f.push(k)}n(f)}else{const{msg:l}=x.data;v.info(l)}})}return e.jsxs("div",{children:[a,e.jsx("h1",{children:"催收信发送"}),e.jsx("h3",{children:"发送给用户"}),e.jsx(At,{type:"user",transdata:u,send:S})]})}function ye(){r.useState(!1),r.useEffect(()=>{we.defaults.baseURL="https://apartment-server.wangminan.me",s(1,100)},[]);function s(u,h){L({method:"GET",url:`/api/message/receiver/inbox?pageNum=${u}&pageSize=${h}`}).then(y=>{const{code:n,result:j}=y.data;if(n!==2e3){const{msg:w}=y.data;alert(w)}})}return e.jsx("div",{})}const Ot=[{title:"床位ID",dataIndex:"id",key:"id"},{title:"床位名",dataIndex:"name",key:"name"},{title:"所属房间的id",dataIndex:"roomId",key:"roomId"},{title:"押金收据单号",dataIndex:"receiptId",key:"receiptId"},{title:"床位使用情况",dataIndex:"isInUse",key:"isInUse"}];function Ee(s){const{lognum:u}=s,[h,y]=r.useState(!1),[n,j]=r.useState([{id:"",userId:"",name:"",type:"",applicationStatus:"",depositStatus:"",paymentId:"",createTime:"",updateTime:"",fileUrl:""}]),[w,v]=r.useState([]),[a,S]=r.useState(0),[F,c]=r.useState(!1),[T,o]=r.useState(!1),[x,g]=r.useState(!1),[l,f]=r.useState(""),{tableitems:A,tabledata:k,tablepage:K,tabletitle:H}=s,{getBed:z}=s,[M,ee]=r.useState(!0),[Fe,C]=r.useState(!1),[te,Te]=ve.useMessage(),J=Qe();r.useEffect(()=>{we.defaults.baseURL="https://apartment-server.wangminan.me",u===3?oe(1,100,"/api/application/apply/status/center"):u===2?oe(1,100,"/api/application/apply/status/center/checkin"):u===5?oe(1,100,"/api/application/apply/status/apartment"):oe(1,100,"/api/application/apply/status/department")},[]);function Me(){let q=[];j(G=>{for(let X=0;X<G.length;X++)q.push(e.jsx(b,{className:"gutter-row",span:8,children:e.jsxs(gt,{title:G[X].type+"申请",bordered:!1,children:[e.jsx(D,{title:"ID",content:G[X].id}),e.jsx(D,{title:"Type",content:G[X].type}),e.jsx(D,{title:"ApplicationStatus",content:G[X].applicationStatus}),e.jsx("p",{}),e.jsx(U,{onClick:()=>R(X),children:"查看"})]})}));return v(q),G})}function oe(q,G,X){L.get(X,{params:{pageNum:q,pageSize:G}}).then(ke=>{const{code:ze,result:Ke}=ke.data;if(ze===2e3){const{list:N}=Ke;if(N.length===0){C(!0),PubSub.publish("cardsreturned",!0);return}let Ae=[];for(let $=0;$<N.length;$++){let Q={};Q.key=ie(),Q.id=N[$].id,Q.userId=N[$].userId,Q.paymentId=N[$].paymentId,N[$].type===0?Q.type="入住":N[$].type===1?Q.type="调宿":N[$].type===2&&(Q.type="退宿"),Q.fileUrl=N[$].fileUrl,Q.applicationStatus=N[$].applicationStatus,N[$].depositStatus===0?Q.depositStatus="未缴纳":N[$].depositStatus===1?Q.depositStatus="已缴纳":N[$].depositStatus===2&&(Q.depositStatus="已退回"),Q.createTime=N[$].createTime,Q.updateTime=N[$].updateTime,Ae.push(Q)}j(Ae),Me(),PubSub.publish("cardsreturned",!0)}else{const{msg:N}=ke.data;te.info(N)}})}function Ne(){o(!0)}function Ve(){g(!0),L({method:"POST",url:"/api/application/apply/status/center",data:{id:n[a].id,bedId:l}}).then(q=>{const{code:G}=q.data;if(G===2e3)te.info("分配完成"),g(!1),oe(1,100);else{const{msg:X}=q.data;te.info(X),g(!1)}})}function _e(){o(!1)}function Ce(q){f(q.target.value)}const R=q=>{S(()=>q),y(!0)},le=()=>{y(!1)};function ae(q){L({method:"POST",url:q,data:{id:n[a].id,pass:M}}).then(G=>{const{code:X}=G.data;if(X===2e3)te.info("审批完成"),getOtherReview(1,100);else{const{msg:ke}=G.data;te.info(ke)}})}function pe(){ee(!0),u===2?ae("/api/application/apply/status/center/checkin"):u===6?ae("/api/application/apply/status/department"):u===5&&ae("/api/application/apply/status/apartment")}function Re(){ee(!1),u===2?ae("/api/application/apply/status/center/checkin"):u===6?ae("/api/application/apply/status/department"):u===5&&ae("/api/application/apply/status/apartment")}function Ue(){J("/home/welcome")}if(PubSub.subscribe("cardsreturned",(q,G)=>{c(G)}),F){if(Fe===!0)return e.jsxs("div",{children:[Te,e.jsx(de,{orientation:"middle",children:"申请页面"}),e.jsx("p",{children:"暂时没有新的申请，休息一下吧"}),e.jsx(U,{onClick:Ue,children:"刷新"})]});if(u===3)return e.jsxs("div",{children:[Te,e.jsx(de,{orientation:"middle",children:"申请页面"}),e.jsx(B,{gutter:[16,20],children:w}),e.jsxs(Se,{width:640,placement:"right",closable:!1,onClose:le,open:h,children:[e.jsx("p",{className:"site-description-item-profile-p",style:{marginBottom:24},children:"申请表"}),e.jsx("br",{}),e.jsxs(B,{children:[e.jsx(b,{span:12,children:e.jsx(D,{title:"ID",content:n[a].id})}),e.jsx(b,{span:12,children:e.jsx(D,{title:"UserID",content:n[a].userId})})]}),e.jsxs(B,{children:[e.jsx(b,{span:12,children:e.jsx(D,{title:"Type",content:n[a].type})}),e.jsx(b,{span:12,children:e.jsx(D,{title:"ApplicationStatus",content:n[a].applicationStatus})})]}),e.jsxs(B,{children:[e.jsx(b,{span:24,children:e.jsx(D,{title:"DepositStatus",content:n[a].depositStatus})}),e.jsx(b,{span:24,children:e.jsx(D,{title:"PaymentId",content:n[a].paymentId})})]}),e.jsxs(B,{children:[e.jsx(b,{span:24,children:e.jsx(D,{title:"createTime",content:n[a].createTime})}),e.jsx(b,{span:24,children:e.jsx(D,{title:"updateTime",content:n[a].updateTime})})]}),e.jsx(B,{children:e.jsx(b,{span:24,children:e.jsx("a",{href:n[a].fileUrl,children:"申请详情"})})}),e.jsx(de,{}),e.jsx(U,{onClick:le,children:"Back"}),e.jsx(U,{type:"primary",onClick:Ne,children:"分配床位"})]}),e.jsxs(et,{title:"Title",open:T,onOk:Ve,okText:"提交",confirmLoading:x,onCancel:_e,cancelText:"关闭",children:[e.jsxs("p",{children:["请在此键入要分配给",n[a].userId,"号用户的床位"]}),e.jsx(re,{onChange:Ce}),e.jsx(Oe,{checkonly:!0,tableitems:A,getBed:z,tabletype:"bed",columns:Ot,tabledata:k,tablepage:K,tabletitle:H})]})]});if(u===2)return e.jsxs("div",{children:[Te,e.jsx(de,{orientation:"middle",children:"申请页面"}),e.jsx(B,{gutter:[16,20],children:w}),e.jsxs(Se,{width:640,placement:"right",closable:!1,onClose:le,open:h,children:[e.jsx("p",{className:"site-description-item-profile-p",style:{marginBottom:24},children:"申请表"}),e.jsx("br",{}),e.jsxs(B,{children:[e.jsx(b,{span:12,children:e.jsx(D,{title:"ID",content:n[a].id})}),e.jsx(b,{span:12,children:e.jsx(D,{title:"UserID",content:n[a].userId})})]}),e.jsxs(B,{children:[e.jsx(b,{span:12,children:e.jsx(D,{title:"Type",content:n[a].type})}),e.jsx(b,{span:12,children:e.jsx(D,{title:"ApplicationStatus",content:n[a].applicationStatus})})]}),e.jsxs(B,{children:[e.jsx(b,{span:24,children:e.jsx(D,{title:"DepositStatus",content:n[a].depositStatus})}),e.jsx(b,{span:24,children:e.jsx(D,{title:"PaymentId",content:n[a].paymentId})})]}),e.jsxs(B,{children:[e.jsx(b,{span:24,children:e.jsx(D,{title:"createTime",content:n[a].createTime})}),e.jsx(b,{span:24,children:e.jsx(D,{title:"updateTime",content:n[a].updateTime})})]}),e.jsx(B,{children:e.jsx(b,{span:24,children:e.jsx("a",{href:n[a].fileUrl,children:"申请详情"})})}),e.jsx(de,{}),e.jsx(U,{onClick:le,children:"Back"}),e.jsx(U,{type:"primary",onClick:pe,children:"批准"}),e.jsx(U,{onClick:Re,children:"驳回"})]})]});if(u===6||u==5)return e.jsxs("div",{children:[Te,e.jsx(de,{orientation:"middle",children:"申请页面"}),e.jsx(B,{gutter:[16,20],children:w}),e.jsxs(Se,{width:640,placement:"right",closable:!1,onClose:le,open:h,children:[e.jsx("p",{className:"site-description-item-profile-p",style:{marginBottom:24},children:"申请表"}),e.jsx("br",{}),e.jsxs(B,{children:[e.jsx(b,{span:12,children:e.jsx(D,{title:"ID",content:n[a].id})}),e.jsx(b,{span:12,children:e.jsx(D,{title:"UserID",content:n[a].userId})})]}),e.jsxs(B,{children:[e.jsx(b,{span:12,children:e.jsx(D,{title:"Type",content:n[a].type})}),e.jsx(b,{span:12,children:e.jsx(D,{title:"ApplicationStatus",content:n[a].applicationStatus})})]}),e.jsxs(B,{children:[e.jsx(b,{span:24,children:e.jsx(D,{title:"DepositStatus",content:n[a].depositStatus})}),e.jsx(b,{span:24,children:e.jsx(D,{title:"PaymentId",content:n[a].paymentId})})]}),e.jsxs(B,{children:[e.jsx(b,{span:24,children:e.jsx(D,{title:"createTime",content:n[a].createTime})}),e.jsx(b,{span:24,children:e.jsx(D,{title:"updateTime",content:n[a].updateTime})})]}),e.jsx(B,{children:e.jsx(b,{span:24,children:e.jsx("a",{href:n[a].fileUrl,children:"申请详情"})})}),e.jsx(de,{}),e.jsx(U,{onClick:le,children:"Back"}),e.jsx(U,{type:"primary",onClick:pe,children:"批准"}),e.jsx(U,{onClick:Re,children:"驳回"})]})]})}else return e.jsxs("div",{children:[e.jsx(de,{orientation:"middle",children:"申请页面"}),e.jsx(Be,{})]})}const D=({title:s,content:u})=>e.jsxs("div",{className:"site-description-item-profile-wrapper",children:[e.jsxs("p",{className:"site-description-item-profile-p-label",children:[s,":"]}),u]});function Ft(s){const[u,h]=r.useState(""),[y,n]=r.useState(!1),[j,w]=r.useState(""),[v,a]=r.useState(!1),{getOutPay:S}=s,{tabletype:F,columns:c,tabledata:T,tablepage:o,tabletitle:x,tableitems:g}=s;r.useState(!1);const[l,f]=ve.useMessage();r.useEffect(()=>{we.defaults.baseURL="https://apartment-server.wangminan.me",S(1,100),A(),k()},[]);function A(){L({method:"GET",url:"/api/finance/center/withhold/download"}).then(z=>{const{code:M}=z.data;if(M===2e3){const{result:ee}=z.data;h(ee),n(!0)}else{const{msg:ee}=z.data;l.info(ee)}})}function k(){L({method:"GET",url:"/api/finance/center/charge/download"}).then(z=>{const{code:M}=z.data;if(M===2e3){const{result:ee}=z.data;w(ee),a(!0)}else{const{msg:ee}=z.data;l.info(ee)}})}function K(){window.open(u)}function H(){window.open(j)}return y&&v?e.jsxs("div",{children:[f,e.jsx(U,{onClick:K,children:"下载外部单位代扣表"}),e.jsx(Oe,{tableitems:g,checkonly:!0,tabletype:"outpay",getOutPay:S,columns:c,tabledata:T,tablepage:o,tabletitle:x}),e.jsx("br",{}),e.jsx(U,{onClick:H,children:"下载自收表"})]}):e.jsx("div",{children:e.jsx(Be,{})})}const Rt={"x-oss-storage-class":"Standard","x-oss-object-acl":"public-read","x-oss-forbid-overwrite":"true"},Lt=()=>{function s(){return((1+window.crypto.getRandomValues(new Uint32Array(1))[0])*65536|0).toString(16).substring(1)}return`${+new Date}_${s()}${s()}`},Dt=async()=>await L.get("https://sts.wangminan.me/oss"),Et=async(s,u,h)=>{const y=await Dt();return await new St({endpoint:"oss-cn-shanghai.aliyuncs.com",accessKeyId:y.data.AccessKeyId,accessKeySecret:y.data.AccessKeySecret,stsToken:y.data.SecurityToken,bucket:"wangminan-shanghai-files",useFetch:!0,secure:!0,refreshSTSToken:async()=>{const j=await L.get("https://sts.wangminan.me/oss");return{accessKeyId:j.AccessKeyId,accessKeySecret:j.AccessKeySecret,stsToken:j.SecurityToken}}}).put(s+u+"_"+Lt()+"."+h.name.split(".")[1],h,{headers:Rt})};function Bt(){const[s,u]=r.useState([]),[h,y]=r.useState(!1),[n,j]=ve.useMessage(),w=async()=>{try{if(y(!0),s[0].size>10*1024*1024){n.error("照片过大，请进行压缩");return}const a=await Et("apartment/user/face/","人脸识别",s[0]);L.get("/api/auth/face/user",{params:{faceUrl:a.url}}).then(S=>{if(S.data.code===2e3){const c=S.data.user.name,T=S.data.user.bedId;n.info("人脸识别成功！"),n.info("此人是："+c+",床位号："+T)}else{const{msg:c}=S.data;n.info("非法闯入，此人不存在"),console.log(c)}})}catch(a){console.log(a)}finally{y(!1)}},v={onRemove:a=>{const S=s.indexOf(a),F=s.slice();F.splice(S,1),u(F)},beforeUpload:a=>(u([...s,a]),!1),fileList:s};return e.jsxs("div",{children:[j,e.jsx(yt,{...v,children:e.jsx(U,{icon:e.jsx(bt,{}),children:"Select File"})}),e.jsx(U,{type:"primary",onClick:w,disabled:s.length===0,loading:h,style:{marginTop:16},children:h?"Uploading":"Start Upload"})]})}const Ie={textAlign:"center",minHeight:120,lineHeight:"120px",color:"#000",backgroundColor:"#eee"},be={textAlign:"center",lineHeight:"120px"};function Mt(s){const{logOut:u}=s,{openAddDrawer:h,tableitems:y}=s,{apartAdd:n,roomAdd:j,bedAdd:w}=s,{getApart:v,getRoom:a,getBed:S,getOutPay:F}=s,{lognum:c,userid:T,textitem:o,usermsg:x,columns:g,tabledata:l,tablepage:f,tabletitle:A}=s,k=o[c].routers,[K,H]=r.useState(!1);function z(){u()}if(c===1)return e.jsx(ne,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(Z,{style:{minHeight:"100vh"},children:[e.jsx(he,{style:be,collapsible:!0,collapsed:K,onCollapse:M=>H(M),children:e.jsx(je,{mode:"inline",theme:"dark",textitem:o[c].item,routers:k})}),e.jsxs(Z,{children:[e.jsx(xe,{children:e.jsxs(B,{children:[e.jsx(b,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ye,{})}),e.jsx(b,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"LogOut"})})]})}),e.jsx(fe,{style:Ie,children:e.jsxs(ce,{children:[e.jsx(E,{path:"/home/welcome",element:e.jsx(ge,{job:o[c].name,usermsg:x})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/home/welcome"})})]})})]})]})});if(c===2)return e.jsx(ne,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(Z,{style:{minHeight:"100vh"},children:[e.jsx(he,{style:be,collapsible:!0,collapsed:K,onCollapse:M=>H(M),children:e.jsx(je,{mode:"inline",theme:"dark",textitem:o[c].item,routers:k})}),e.jsxs(Z,{children:[e.jsx(xe,{children:e.jsxs(B,{children:[e.jsx(b,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ye,{})}),e.jsx(b,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"LogOut"})})]})}),e.jsx(fe,{style:Ie,children:e.jsxs(ce,{children:[e.jsx(E,{path:"/home/welcome",element:e.jsx(ge,{job:o[c].name,usermsg:x})}),e.jsx(E,{path:"/home/checkin",element:e.jsx(Ee,{lognum:c})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/home/welcome"})})]})})]})]})});if(c===3)return e.jsx(ne,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(Z,{style:{minHeight:"100vh"},children:[e.jsx(he,{style:be,collapsible:!0,collapsed:K,onCollapse:M=>H(M),children:e.jsx(je,{mode:"inline",theme:"dark",textitem:o[c].item,routers:k})}),e.jsxs(Z,{children:[e.jsx(xe,{children:e.jsxs(B,{children:[e.jsx(b,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ye,{})}),e.jsx(b,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"LogOut"})})]})}),e.jsx(fe,{style:Ie,children:e.jsxs(ce,{children:[e.jsx(E,{path:"/home/welcome",element:e.jsx(ge,{job:o[c].name,usermsg:x})}),e.jsx(E,{path:"/home/promise",element:e.jsx(Ee,{lognum:c,tableitems:y,getBed:S,tabletype:"bed",columns:g,tabledata:l,tablepage:f,tabletitle:A})}),e.jsx(E,{path:"/home/apart",element:e.jsx(Oe,{tableitems:y,openAddDrawer:()=>h("apart"),addMsg:o[c].addmessages.apart,addfun:n,getApart:v,tabletype:"apart",columns:g,tabledata:l,tablepage:f,tabletitle:A})}),e.jsx(E,{path:"/home/room",element:e.jsx(Oe,{tableitems:y,openAddDrawer:()=>h("room"),addMsg:o[c].addmessages.room,addfun:j,getRoom:a,tabletype:"room",columns:g,tabledata:l,tablepage:f,tabletitle:A})}),e.jsx(E,{path:"/home/bed",element:e.jsx(Oe,{tableitems:y,openAddDrawer:()=>h("bed"),addMsg:o[c].addmessages.bed,addfun:w,getBed:S,tabletype:"bed",columns:g,tabledata:l,tablepage:f,tabletitle:A})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/home/welcome"})})]})})]})]})});if(c===4)return e.jsx(ne,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(Z,{style:{minHeight:"100vh"},children:[e.jsx(he,{style:be,collapsible:!0,collapsed:K,onCollapse:M=>H(M),children:e.jsx(je,{mode:"inline",theme:"dark",textitem:o[c].item,routers:k})}),e.jsxs(Z,{children:[e.jsx(xe,{children:e.jsxs(B,{children:[e.jsx(b,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ye,{})}),e.jsx(b,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"LogOut"})})]})}),e.jsx(fe,{style:Ie,children:e.jsxs(ce,{children:[e.jsx(E,{path:"/home/welcome",element:e.jsx(ge,{job:o[c].name,usermsg:x})}),e.jsx(E,{path:"/home/paylist",element:e.jsx(Ft,{tableitems:y,getOutPay:F,tabletype:"bed",columns:g,tabledata:l,tablepage:f,tabletitle:A})}),e.jsx(E,{path:"/home/collectmsg",element:e.jsx(Pt,{lognum:c,userid:T})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/home/welcome"})})]})})]})]})});if(c===5)return e.jsx(ne,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(Z,{style:{minHeight:"100vh"},children:[e.jsx(he,{style:be,collapsible:!0,collapsed:K,onCollapse:M=>H(M),children:e.jsx(je,{mode:"inline",theme:"dark",textitem:o[c].item,routers:k})}),e.jsxs(Z,{children:[e.jsx(xe,{children:e.jsxs(B,{children:[e.jsx(b,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ye,{})}),e.jsx(b,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"LogOut"})})]})}),e.jsx(fe,{style:Ie,children:e.jsxs(ce,{children:[e.jsx(E,{path:"/home/welcome",element:e.jsx(ge,{job:o[c].name,usermsg:x})}),e.jsx(E,{path:"/home/checkin",element:e.jsx(Ee,{lognum:c})}),e.jsx(E,{path:"/home/face",element:e.jsx(Bt,{})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/home/welcome"})})]})})]})]})});if(c===6)return e.jsx(ne,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(Z,{style:{minHeight:"100vh"},children:[e.jsx(he,{style:be,collapsible:!0,collapsed:K,onCollapse:M=>H(M),children:e.jsx(je,{mode:"inline",theme:"dark",textitem:o[c].item,routers:k})}),e.jsxs(Z,{children:[e.jsx(xe,{children:e.jsxs(B,{children:[e.jsx(b,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ye,{})}),e.jsx(b,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"LogOut"})})]})}),e.jsx(fe,{style:Ie,children:e.jsxs(ce,{children:[e.jsx(E,{path:"/home/welcome",element:e.jsx(ge,{job:o[c].name,usermsg:x})}),e.jsx(E,{path:"/home/checkin",element:e.jsx(Ee,{lognum:c})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/home/welcome"})})]})})]})]})});if(c===7)return e.jsx(ne,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(Z,{style:{minHeight:"100vh"},children:[e.jsx(he,{style:be,collapsible:!0,collapsed:K,onCollapse:M=>H(M),children:e.jsx(je,{mode:"inline",theme:"dark",textitem:o[c].item,routers:k})}),e.jsxs(Z,{children:[e.jsx(xe,{children:e.jsxs(B,{children:[e.jsx(b,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ye,{})}),e.jsx(b,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"LogOut"})})]})}),e.jsx(fe,{style:Ie,children:e.jsxs(ce,{children:[e.jsx(E,{path:"/home/welcome",element:e.jsx(ge,{job:o[c].name,usermsg:x})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/home/welcome"})})]})})]})]})})}function Nt(s){const{apartUpdate:u,roomUpdate:h,bedUpdate:y}=s,{type:n,title:j,placement:w,onClose:v,open:a,tableitems:S,records:F}=s,[c,T]=r.useState(!1),[o,x]=r.useState(0),[g,l]=r.useState({status:0});function f(){T(!0),u(F.index,g),T(!1)}function A(H){l(z=>(z.status=H.target.value,z)),x(H.target.value)}function k(){T(!0),h(F.index),T(!1)}function K(){T(!0),y(F.index),T(!1)}if(S.length===0)return e.jsx(Se,{title:j,placement:w,onClose:v,open:a,children:e.jsx(Be,{})});if(n==="apart")return e.jsxs(Se,{title:j,placement:w,onClose:v,open:a,children:[S,"此公寓",e.jsxs(Pe.Group,{onChange:A,value:o,children:[e.jsx(Pe,{value:0,children:"正常使用"}),e.jsx(Pe,{value:1,children:"启用中"}),e.jsx(Pe,{value:2,children:"弃用中"}),e.jsx(Pe,{value:3,children:"已弃用"})]}),e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(U,{type:"primary",loading:c,onClick:f,children:"修改"})})]});if(n==="room")return e.jsxs(Se,{title:j,placement:w,onClose:v,open:a,children:[S,e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(U,{type:"primary",loading:c,onClick:k,children:"修改"})})]});if(n==="bed")return e.jsxs(Se,{title:j,placement:w,onClose:v,open:a,children:[S,e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(U,{type:"primary",loading:c,onClick:K,children:"修改"})})]})}function _(s,u,h,y,n){return{key:u,icon:h,children:y,label:s,type:n}}const zt=[{},{id:1,name:"超级管理员",item:[_("管理员账号管理","1",e.jsx(V,{})),_("外部单位管理","2",e.jsx(V,{})),_("公寓管理","3",e.jsx(V,{})),_("房间管理","4",e.jsx(V,{}))]},{id:2,name:"入住办理员",item:[_("住宿申请审核","1",e.jsx(V,{})),_("床位编号录入","2",e.jsx(V,{})),_("人脸录入确认","3",e.jsx(V,{}))],routers:[{route:"/checkin"},{route:"/bedid"},{route:"/face"}]},{id:3,name:"宿舍调配员",item:[_("宿舍分配","1",e.jsx(V,{})),_("公寓管理","2",e.jsx(V,{})),_("房间管理","3",e.jsx(V,{})),_("床位管理","4",e.jsx(V,{}))],routers:[{route:"/promise"},{route:"/apart"},{route:"/room"},{route:"/bed"}],addmessages:{apart:"name为公寓名 position为公寓地址 location为经纬度地址",room:"name为宿舍号 sex为性别，应填写“男”或“女” usage为宿舍用途 type为房间种类，应填写“n人间”，n为整数 isForCadre为干部房标识，应填写“是”或“否” isReserved代表此房间是否保留，应填写“是”或“否” totalFee为宿舍费用 selfPayFee为自费费用 refundFee为单位报销费用 ",bed:"name为床位名 roomId为床位所在的宿舍号 receiptId为押金收据单号 isInUse代表床位是否已被占用，应填写“是”或“否” "}},{id:4,name:"财务管理员",item:[_("缴费统计表","1",e.jsx(V,{})),_("催收信","2",e.jsx(V,{})),_("宿舍情况查询","3",e.jsx(V,{}))],routers:[{route:"/paylist"},{route:"/collectmsg"},{route:"/roomchexk"}]},{id:5,name:"宿舍管理班组",item:[_("待办申请","1",e.jsx(V,{})),_("人脸识别","2",e.jsx(V,{}))],routers:[{route:"/checkin"},{route:"/face"}]},{id:6,name:"外部单位入住办理员",item:[_("入住申请审核","1",e.jsx(V,{}))],routers:[{route:"/checkin"}]}];function Kt(){const[s,u]=r.useState(!1),[h,y]=r.useState(0),[n,j]=r.useState(null),[w,v]=r.useState(""),[a,S]=r.useState([]),[F,c]=r.useState([]),[T,o]=r.useState(0),[x,g]=r.useState(""),[l,f]=r.useState(!1),[A,k]=r.useState(""),[K,H]=r.useState({}),[z,M]=r.useState([]),[ee,Fe]=r.useState([]),[C,te]=r.useState({}),[Te,J]=r.useState([]),[Me,oe]=r.useState(""),[Ne,Ve]=r.useState(null),[_e,Ce]=r.useState(!1),[R,le]=ve.useMessage();Qe(),r.useEffect(()=>{we.defaults.baseURL="https://apartment-server.wangminan.me",we.get("/api/auth/hello")},[]);const ae=[{title:"Name",dataIndex:"name",key:"name"},{title:"Position",dataIndex:"position",key:"position"},{title:"Location",dataIndex:"location",key:"location"},{title:"Action",key:"action",render:(d,t,m)=>e.jsxs(ne,{size:"middle",children:[e.jsx(U,{type:"primary",onClick:()=>Ue(m,t,"apart"),children:"修改此条目"}),e.jsxs(U,{type:"primary",onClick:()=>Ke(m),children:["删除",t.name]})]})}];function pe(d){M(()=>{let t=[];for(let m=0;m<d.length-1;m++)t.push(d[m].dataIndex);return t}),M(t=>t)}function Re(d){te(()=>(C[d.target.id]=d.target.value,C))}function Ue(d,t,m){oe(()=>m),H(t),f(!0),k(()=>"修改第"+(d+1)+"条"),M(O=>(H(P=>(Fe(()=>{let I=[];for(let Y=0;Y<O.length;Y++)I.push(e.jsxs("div",{children:[e.jsx("p",{children:O[Y]}),e.jsx(re,{id:O[Y],onChange:Re,defaultValue:P[O[Y]]})]},ie())),te(W=>(W[O[Y]]=P[O[Y]],W));return I}),P)),O))}function q(d){te(t=>(t[d.target.id]=d.target.value,t))}function G(d){oe(()=>d),k(()=>"新增"+d+"条目"),M(t=>(H(m=>(Fe(()=>{let O=[];for(let P=0;P<t.length;P++)t[P]==="receiptId"||t[P]==="isInUse"||(t[P]==="location"?O.push(e.jsxs("div",{children:[e.jsx("p",{children:t[P]}),e.jsx(re,{id:t[P],onChange:q,defaultValue:"请输入合法经纬度,以英文逗号分隔"})]},ie())):O.push(e.jsxs("div",{children:[e.jsx("p",{children:t[P]}),e.jsx(re,{id:t[P],onChange:q,defaultValue:""})]},ie())));return O}),m)),t))}function X(){let d=[];return te(t=>(d=t.location.split(","),d.length!=2?(R.info("Location格式不正确！"),!1):(t.lon0=d[0],t.lon1=d[1],t))),!0}function ke(){X(),L({method:"POST",url:"/api/management/apartment",data:{foremanAdminId:h,name:C.name,position:C.position,positionLongitude:C.lon1,positionLatitude:C.lon0,status:0}}).then(d=>{const{code:t}=d.data;if(t===2e3)N(1,100),R.info("增加已完成,请刷新页面以查看最新结果");else{const{msg:m}=d.data;R.info(m)}})}function ze(d,t){X(),J(m=>(L({method:"PUT",url:`/api/management/apartment/${m[d]}`,data:{foremanAdminId:h,name:C.name,position:C.position,positionLongitude:C.lon1,positionLatitude:C.lon0,status:t.status}}).then(O=>{const{code:P}=O.data;if(P===2e3)N(1,100),R.info("修改已完成，请刷新以查看修改结果"),f(!1);else{const{msg:I}=O.data;R.info(I),f(!1)}}),m))}function Ke(d){J(t=>{L({method:"DELETE",url:`/api/management/apartment/${t[d]}`}).then(m=>{const{code:O}=m.data;if(O===2e3)N(1,100),R.info("删除已完成,请刷新页面以查看最新结果");else{const{msg:P}=m.data;R.info(P)}})})}function N(d,t){L({method:"GET",url:`/api/management/apartment?pageNum=${d}&pageSize=${t}`}).then(m=>{const{code:O,msg:P}=m.data,{list:I,total:Y}=m.data.result;if(O===2e3){g("公寓列表"),o(Math.ceil(Y/t)),S(ae),pe(ae),J(i=>(i=[],i));let W=[];for(let i=0;i<I.length;i++){J(se=>(se.push(I[i].id),se));let p={};p.key=ie(),p.index=i,p.name=I[i].name,p.position=I[i].position,p.location=I[i].location,W.push(p)}c(W),Ce(()=>(me.publish("tablereturned",!0),!0))}else R.info(P)})}const Ae=[{title:"宿舍号",dataIndex:"name",key:"name"},{title:"性别",dataIndex:"sex",key:"sex"},{title:"用途",dataIndex:"usage",key:"usage"},{title:"房间规格",dataIndex:"type",key:"type"},{title:"干部房",dataIndex:"isForCadre",key:"isForCadre"},{title:"保留间",dataIndex:"isReserved",key:"isReserved"},{title:"房间总价",dataIndex:"totalFee",key:"totalFee"},{title:"自理部分",dataIndex:"selfPayFee",key:"selfPayFee"},{title:"单位报销",dataIndex:"refundFee",key:"refundFee"},{title:"Action",key:"action",render:(d,t,m)=>e.jsxs(ne,{size:"middle",children:[e.jsx(U,{type:"primary",onClick:()=>Ue(m,t,"room"),children:"修改此条目"}),e.jsxs(U,{type:"primary",onClick:()=>st(m),children:["删除",t.name]})]})}];function $(){let d=!0;return te(t=>(t.sex==="man"||t.sex==="男"?t.sex=0:t.sex==="woman"||t.sex==="女"?t.sex=1:(R.info("性别格式非法"),d=!1),t.isForCadre==="是"?t.isForCadre=1:t.isForCadre==="否"?t.isForCadre=0:(R.info("干部房状态格式非法"),d=!1),t.isReserved==="是"?t.isReserved=1:t.isReserved==="否"?t.isReserved=0:(R.info("保留间状态格式非法"),d=!1),t.type==="单人间"?t.type=1:t.type==="双人间"?t.type=2:t.type=parseInt(t.type.substring(0,t.type.indexOf("人"))),parseInt(t.totalFee)!==parseInt(t.selfPayFee)+parseInt(t.refundFee)&&(R.info("总价不等于单位报销部分和个人自理部分之和"),console.log("总"+t.totalFee+"B"+t.refundFee+"S"+t.selfPayFee),d=!1),t)),d}function Q(){$()&&L({method:"POST",url:"/api/management/room",data:{apartmentId:1,name:C.name,sex:C.sex,usage:C.usage,isForCadre:C.isForCadre,isReserved:C.isReserved,type:C.type,totalFee:C.totalFee,selfPayFee:C.selfPayFee,refundFee:C.refundFee}}).then(d=>{const{code:t}=d.data;if(t===2e3)Le(1,100),R.info("增加已完成,请刷新页面以查看最新结果");else{const{msg:m}=d.data;R.info(m)}})}function nt(d){$()&&J(t=>(L({method:"PUT",url:`/api/management/room/${t[d]}`,data:{apartmentId:1,name:C.name,sex:C.sex,usage:C.usage,isForCadre:C.isForCadre,isReserved:C.isReserved,type:C.type,totalFee:C.totalFee,selfPayFee:C.selfPayFee,refundFee:C.refundFee}}).then(m=>{const{code:O}=m.data;if(O===2e3)Le(1,100),R.info("修改已完成，请刷新以查看修改结果"),f(!1);else{const{msg:P}=m.data;R.info(P),f(!1)}}),t))}function st(d){J(t=>{L({method:"DELETE",url:`/api/management/room/${t[d]}`}).then(m=>{const{code:O}=m.data;if(O===2e3)Le(1,100),R.info("删除已完成,请刷新页面以查看最新结果");else{const{msg:P}=m.data;R.info(P)}})})}function Le(d,t){L.get("/api/management/room",{params:{pageNum:d,pageSize:t,apartmentId:1,query:"",isForCadre:"",type:""}}).then(m=>{const{code:O,msg:P}=m.data,{list:I,total:Y}=m.data.result;if(O===2e3){g("房间列表"),o(Math.ceil(Y/t)),o(i=>(me.publish("tablepage",i),i)),S(Ae),pe(Ae),J(i=>(i=[],i));let W=[];for(let i=0;i<I.length;i++){J(se=>(se.push(I[i].id),se));let p={};p.key=ie(),p.index=i,p.name=I[i].name,I[i].sex===0?p.sex="man":I[i].sex===1&&(p.sex="woman"),p.usage=I[i].usage,I[i].type===1?p.type="单人间":I[i].type===2?p.type="双人间":p.type=I[i].type+"人间",I[i].isForCadre?p.isForCadre="是":p.isForCadre="否",I[i].isReserved?p.isReserved="是":p.isReserved="否",p.totalFee=I[i].totalFee,p.selfPayFee=I[i].selfPayFee,p.refundFee=I[i].refundFee,W.push(p)}c(W),Ce(()=>(me.publish("tablereturned",!0),!0))}else R.info(P)})}const Je=[{title:"床位ID",dataIndex:"id",key:"id"},{title:"床位名",dataIndex:"name",key:"name"},{title:"所属房间的id",dataIndex:"roomId",key:"roomId"},{title:"押金收据单号",dataIndex:"receiptId",key:"receiptId"},{title:"床位使用情况",dataIndex:"isInUse",key:"isInUse"},{title:"Action",key:"action",render:(d,t,m)=>e.jsxs(ne,{size:"middle",children:[e.jsx(U,{type:"primary",onClick:()=>Ue(m,t,"bed"),children:"修改此条目"}),e.jsxs(U,{type:"primary",onClick:()=>ot(m),children:["删除",t.name]})]})}];function it(){let d=!0;return te(t=>(t.isInUse==="是"?t.isInUse=1:t.isInUse==="否"?t.isInUse=0:(R.info("床位使用情况格式非法"),d=!1),t)),d}function at(){L({method:"POST",url:"/api/management/bed",data:{name:C.name,roomId:C.roomId}}).then(d=>{const{code:t}=d.data;if(t===2e3)De(1,100),R.info("增加已完成,请刷新页面以查看最新结果");else{const{msg:m}=d.data;R.info(m)}})}function rt(d){it()&&J(t=>(L({method:"PUT",url:`/api/management/bed/${t[d]}`,data:{name:C.name,roomId:C.roomId,receiptId:C.receiptId,isInUse:C.isInUse}}).then(m=>{const{code:O}=m.data;if(O===2e3)De(1,100),R.info("修改已完成，请刷新以查看修改结果"),f(!1);else{const{msg:P}=m.data;R.info(P),f(!1)}}),t))}function ot(d){J(t=>{L({method:"DELETE",url:`/api/management/bed/${t[d]}`}).then(m=>{const{code:O}=m.data;if(O===2e3)De(1,100),R.info("删除已完成,请刷新页面以查看最新结果");else{const{msg:P}=m.data;R.info(P)}})})}function De(d,t){L.get("/api/management/bed",{params:{pageNum:d,pageSize:t,apartmentId:"",query:"",roomId:"",isInUse:""}}).then(m=>{const{code:O,msg:P}=m.data,{list:I,total:Y}=m.data.result;if(O===2e3){g("床位列表"),o(Math.ceil(Y/t)),o(i=>(me.publish("tablepage",i),i)),S(Je),pe(Je),J(i=>(i=[],i));let W=[];for(let i=0;i<I.length;i++){J(se=>(se.push(I[i].id),se));let p={};p.key=ie(),p.index=i,p.id=I[i].id,p.name=I[i].name,p.roomId=I[i].roomId,p.receiptId=I[i].receiptId,I[i].isInUse===1?p.isInUse="是":p.isInUse="否",W.push(p)}c(W),Ce(()=>(me.publish("tablereturned",!0),!0))}else R.info(P)})}const Xe=[{title:"支票ID",dataIndex:"chequeId",key:"chequeId"},{title:"公寓ID",dataIndex:"departmentId",key:"departmentId"},{title:"是否已支付",dataIndex:"hasPaid",key:"hasPaid"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"支付时间",dataIndex:"payTime",key:"payTime"},{title:"金额",dataIndex:"price",key:"price"}];function lt(d,t){L.get("/api/finance/center/withhold",{params:{pageNum:d,pageSize:t}}).then(m=>{const{code:O,msg:P}=m.data,{list:I,total:Y}=m.data.result;if(O===2e3){g("外部单位代扣表"),S(Xe),pe(Xe),J(i=>(i=[],i));let W=[];for(let i=0;i<I.length;i++){J(se=>(se.push(I[i].id),se));let p={};p.key=ie(),p.index=i,p.id=I[i].id,p.chequeId=I[i].chequeId,p.departmentId=I[i].departmentId,I[i].hasPaid===1?p.hasPaid="是":p.hasPaid="否",p.createTime=I[i].createTime,p.payTime=I[i].payTime,p.price=I[i].price,W.push(p)}c(W),Ce(()=>(me.publish("tablereturned",!0),!0))}else R.info(P)})}function dt(d,t){u(m=>!0),y(d),v(t.id),j(t.name)}function ct(){window.localStorage.removeItem("token"),u(!1)}return s?e.jsxs("div",{children:[le,e.jsx(Mt,{lognum:h,userid:w,usermsg:n,textitem:zt,columns:a,tabledata:F,tablepage:T,tabletitle:x,logOut:ct,getApart:N,getRoom:Le,getBed:De,getOutPay:lt,openAddDrawer:G,addButtons:Ne,tableitems:ee,apartAdd:ke,roomAdd:Q,bedAdd:at}),e.jsx(Nt,{type:Me,title:A,placement:"bottom",onClose:()=>f(!1),open:l,tableitems:ee,records:K,apartUpdate:ze,roomUpdate:nt,bedUpdate:rt})]}):e.jsx("div",{className:"login-box",children:e.jsx("div",{className:"glass",children:e.jsxs("div",{className:"innerlogin",children:[e.jsx("p",{children:"公寓员工管理系统"}),e.jsx("img",{src:Tt}),e.jsxs(ce,{children:[e.jsx(E,{path:"/login",element:e.jsx(kt,{login:dt})}),e.jsx(E,{path:"/register",element:e.jsx(vt,{})}),e.jsx(E,{path:"*",element:e.jsx(ue,{to:"/login"})})]})]})})})}const $e="user_key",Ht={saveUser(s){He.set($e,s)},getUser(){return He.get($e)||{}},removeUser(){He.remove($e)}};Ht.getUser();ut.createRoot(document.getElementById("root")).render(e.jsx(mt,{children:e.jsx(Kt,{})}));
