import{r as l,j as e}from"./react-4fd50329.js";import{c as Y}from"./react-dom-ba68e95b.js";import{B as _}from"./react-router-dom-be6b8ed7.js";import{a as B}from"./axios-4a70c6fc.js";import{J as D}from"./js-encrypt-af0330d8.js";import{s as P}from"./store-b71d9d04.js";import{I as A,T as K,B as C,M as W,S as N,a as Z,P as V,L as z,b as $,C as ee}from"./antd-0f89f11b.js";import{U as q,r as te,s as E,i as R,t as d}from"./@ant-design-4c90188b.js";import{u as Q,a as J,b as S,N as H}from"./react-router-2b4b4887.js";import"./classnames-4ba1ba1a.js";import"./scheduler-765c72db.js";import"./@remix-run-93d98c9a.js";import"./rc-util-12454e0c.js";import"./@babel-5495bcd4.js";import"./react-is-e8e5dbb3.js";import"./rc-resize-observer-0143eda7.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-motion-7e38dc9f.js";import"./rc-menu-53658de8.js";import"./rc-overflow-4c798008.js";import"./@rc-component-0b89941d.js";import"./rc-select-19324a0b.js";import"./rc-virtual-list-787aa573.js";import"./rc-field-form-82675bbe.js";import"./async-validator-7f96df71.js";import"./rc-table-8b9acabd.js";import"./rc-pagination-5ee622e2.js";import"./rc-picker-ec1be246.js";import"./@ctrl-fb5a5473.js";import"./throttle-debounce-87e7e444.js";import"./rc-checkbox-53af7726.js";import"./rc-dropdown-0e52231b.js";import"./rc-tooltip-44f8b257.js";import"./rc-tree-88b0ea7c.js";import"./rc-input-4894e8dc.js";import"./rc-textarea-2f7afde9.js";import"./@emotion-c0b5c018.js";import"./stylis-fad5b415.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const O=B.create({baseURL:"https://apartment-server.wangminan.me"});O.interceptors.request.use(t=>(window.localStorage.getItem("token")!==void 0&&(t.headers.Authorization="Bearer "+window.localStorage.getItem("token")),t),t=>Promise.reject(t));O.interceptors.response.use(t=>(t!==null&&t.data!==null&&t.data.code!==null&&(t.data.code===4012||t.data.code===4010||t.data.code===4030)&&(window.localStorage.removeItem("token"),setTimeout(()=>{window.location.href="/login"},3e3)),t),t=>Promise.reject(t));const se=`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5vwYRBKySNSl/60qRqcD
lDVcNP9j2UyB7yalGI9MtlBEZ16pEiR08TuZjUL00go5LEb6z+ghVlp6UOsWR6i3
r7Q+FleKHG2yStqqaWx+11OQzOjffXQwqb1t/0bq/tzy04KBinSaB/yqnMc0yO8n
rZx8OtUX5rMcM7BjvpFOdnCSFUAOOfKRirfT5RydyGeLPOnBTwJIwpygGu20++UX
MxARO1aAJeUXeI+9g+XcsAi1EKbI2YdjWJ8PQnBC9+lsDRS3w8uKqUOZdYu/FxAy
bEjQ+YOXzfu2PB9+BdilkztV/yuF6hfk7MpGdA2JoBsJlljSYWH1mUE+e9mnUyHi
/wIDAQAB`;function re(t){const r=new D;return r.setPublicKey(se),r.encrypt(t)}const k="user_key",L={saveUser(t){P.set(k,t)},getUser(){return P.get(k)||{}},removeUser(){P.remove(k)}};function oe(t){const r="13777864453",n="root",[a,s]=l.useState(r),[o,c]=l.useState(n),[g,x]=l.useState(!1);function f(m){s(()=>m.target.value)}function h(m){c(()=>m.target.value)}function w(){x(!0),O({method:"POST",url:"/api/auth/login/password",data:{username:a,password:re(o)}}).then(m=>{const{code:i,result:u}=m.data;if(i===2e3)if(window.localStorage.setItem("token",u.token),window.localStorage.setItem("role",u.role),u.user){const j=u.user;L.saveUser(j),t.login(u.role,u.user)}else{const j=u.admin;L.saveUser(j),t.login(u.role,u.admin)}else{const{msg:j}=m.data;c(""),alert(j)}x(!1)})}return e.jsxs("div",{children:[e.jsx(A,{value:a,onChange:f,placeholder:"Enter your username",prefix:e.jsx(q,{className:"site-form-item-icon"}),suffix:e.jsx(K,{title:"Extra information",children:e.jsx(te,{style:{color:"rgba(0,0,0,.45)"}})})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(A.Password,{value:o,onChange:h,placeholder:"input password",iconRender:m=>m?e.jsx(E,{}):e.jsx(R,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(C,{size:"large",type:"primary",loading:g,onClick:w,children:"Login"})]})}function ne(){const[t,r]=l.useState(""),[n,a]=l.useState(""),[s,o]=l.useState(""),[c,g]=l.useState("");function x(i){r(()=>i.target.value)}function f(i,u){g(u!==""&&i!==u?()=>"error":()=>"")}function h(i){a(()=>i.target.value),f(i.target.value,s)}function w(i){o(()=>i.target.value),f(n,i.target.value)}function m(i){n!==s&&alert("")}return e.jsxs("div",{children:[e.jsx(A,{onChange:x,placeholder:"default size",prefix:e.jsx(q,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(A.Password,{onChange:h,placeholder:"input password",iconRender:i=>i?e.jsx(E,{}):e.jsx(R,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(A.Password,{status:c,onChange:w,placeholder:"password again",iconRender:i=>i?e.jsx(E,{}):e.jsx(R,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(C,{size:"large",type:"primary",onClick:m,children:"SignUP"})]})}const ae=""+new URL("apartment-d819f74c.svg",import.meta.url).href;function ie(t){const{routers:r}=t,n=Q();function a(s){n("/home"+r[parseInt(s.key,10)-1].route,{replace:!0})}return e.jsx("div",{children:e.jsx("div",{children:e.jsx(W,{mode:t.mode,theme:t.theme,items:t.textitem,onClick:a})})})}function le(t){return e.jsx(K,{placement:"right",title:"先生/女士",children:e.jsxs("span",{children:["欢迎您，",t.job," ",JSON.parse(t.usermsg).name]})})}function ce(t){const{columns:r,tabledata:n,tablepage:a,tabletitle:s}=t;function o(c){console.log(c)}return e.jsx("div",{children:e.jsxs(N,{direction:"vertical",size:16,children:[e.jsx(Z,{columns:r,dataSource:n,pagination:!1}),e.jsx("br",{}),e.jsx(V,{showQuickJumper:!0,defaultCurrent:1,total:a,onChange:o})]})})}const ue={textAlign:"center",minHeight:120,lineHeight:"120px",color:"#000",backgroundColor:"#fff"},me={textAlign:"center",lineHeight:"120px"};function de(t){const{lognum:r,textitem:n,usermsg:a,columns:s,tabledata:o,tablepage:c,tabletitle:g}=t,x=n[r].routers,[f,h]=l.useState(!1);return e.jsx(N,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(z,{style:{minHeight:"100vh"},children:[e.jsx($,{style:me,collapsible:!0,collapsed:f,onCollapse:w=>h(w),children:e.jsx(ie,{mode:"inline",theme:"dark",textitem:n[r].item,routers:x})}),e.jsx(z,{children:e.jsx(ee,{style:ue,children:e.jsxs(J,{children:[e.jsx(S,{path:"/home/welcome",element:e.jsx(le,{job:n[r].name,usermsg:a})}),e.jsx(S,{path:"/home/apart",element:e.jsx(ce,{columns:s,tabledata:o,tablepage:c,tabletitle:g})}),e.jsx(S,{path:"*",element:e.jsx(H,{to:"/home/welcome"})})]})})})]})})}function p(t,r,n,a,s){return{key:r,icon:n,children:a,label:t,type:s}}const pe=[{},{id:1,name:"超级管理员",item:[p("管理员账号管理","1",e.jsx(d,{})),p("外部单位管理","2",e.jsx(d,{})),p("公寓管理","3",e.jsx(d,{})),p("房间管理","4",e.jsx(d,{}))]},{id:2,name:"入住办理员",item:[p("入住申请审核","1",e.jsx(d,{})),p("床位编号录入","2",e.jsx(d,{})),p("人脸录入确认","3",e.jsx(d,{}))]},{id:3,name:"宿舍调配员",item:[p("住/调宿申请","1",e.jsx(d,{})),p("公寓管理","2",e.jsx(d,{})),p("房间管理","3",e.jsx(d,{})),p("床位管理","4",e.jsx(d,{}))],routers:[{route:"/promise"},{route:"/apart"},{route:"/room"},{route:"/bed"}]}],ge=[{title:"Name",dataIndex:"name",key:"name"},{title:"Position",dataIndex:"position",key:"position"},{title:"Location",dataIndex:"location",key:"location"},{title:"Action",key:"action",render:(t,r)=>e.jsxs(N,{size:"middle",children:[e.jsx(C,{children:"修改"}),e.jsxs(C,{children:["删除",r.name]})]})}];function xe(){const[t,r]=l.useState(!1),[n,a]=l.useState(0),[s,o]=l.useState(null),[c,g]=l.useState([]),[x,f]=l.useState([]),[h,w]=l.useState(0),[m,i]=l.useState("");Q(),l.useEffect(()=>{if(window.localStorage.getItem("token")!==void 0){let v=window.localStorage.getItem("user_key"),y=window.localStorage.getItem("role");j(y,v)}B.defaults.baseURL="https://apartment-server.wangminan.me",B.get("/api/auth/hello")},[]);function u(v,y){O({method:"GET",url:`/api/management/apartment?pageNum=${v}&pageSize=${y}`}).then(T=>{const{code:F,msg:G}=T.data,{list:I,total:X}=T.data.result;if(F===2e3){console.log(I),i("公寓列表"),w(X/y+1),g(ge);let M=[];for(let b=0;b<I.length;b++){let U={};U.key=b+1,U.name=I[b].name,U.position=I[b].position,U.location=I[b].location,M.push(U)}f(M)}else alert(G)})}function j(v,y){r(()=>!0),a(v),o(y),a(3),u(1,10)}return t?e.jsx("div",{children:e.jsx(de,{lognum:n,usermsg:s,textitem:pe,columns:c,tabledata:x,tablepage:h,tabletitle:m})}):e.jsx("div",{className:"login-box",children:e.jsx("div",{className:"glass",children:e.jsxs("div",{className:"innerlogin",children:[e.jsx("p",{children:"公寓员工管理系统"}),e.jsx("img",{src:ae}),e.jsxs(J,{children:[e.jsx(S,{path:"/login",element:e.jsx(oe,{login:j})}),e.jsx(S,{path:"/register",element:e.jsx(ne,{})}),e.jsx(S,{path:"*",element:e.jsx(H,{to:"/login"})})]})]})})})}L.getUser();Y.createRoot(document.getElementById("root")).render(e.jsx(_,{children:e.jsx(xe,{})}));
