import{r as u,j as e,R as Te}from"./react-2ce75adb.js";import{c as et}from"./react-dom-16e2f971.js";import{B as tt}from"./react-router-dom-93ff5a9d.js";import{a as le}from"./axios-4a70c6fc.js";import{q as nt}from"./qs-88f287ae.js";import{J as st}from"./js-encrypt-af0330d8.js";import{I as _,T as Pe,B as T,M as rt,a as at,S as Ee,b as H,c as Le,d as it,e as ot,L as E,f as X,H as Y,R as W,C as B,g as Z,D as he,h as oe}from"./antd-885f35d6.js";import{U as Be,w as lt,x as be,l as Ie,y as D}from"./@ant-design-00ab6f18.js";import{u as De,a as Q,b as F,N as J}from"./react-router-e1c202a2.js";import{P as ae}from"./pubsub-js-164616ad.js";import{v as V}from"./uuid-a960c1f4.js";import{s as je}from"./store-502a59ff.js";import"./call-bind-892c8155.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./scheduler-765c72db.js";import"./@remix-run-93d98c9a.js";import"./side-channel-b75e8576.js";import"./object-inspect-13342da8.js";import"./rc-util-717c2e4e.js";import"./@babel-5495bcd4.js";import"./react-is-e8e5dbb3.js";import"./classnames-776d2d10.js";import"./rc-resize-observer-0a67df73.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-motion-d640d26c.js";import"./rc-menu-de38827f.js";import"./rc-overflow-f5f38188.js";import"./@rc-component-e9870b4d.js";import"./rc-select-cd72be43.js";import"./rc-virtual-list-b8f5faa7.js";import"./rc-drawer-5cb588ed.js";import"./rc-field-form-049586ad.js";import"./async-validator-7f96df71.js";import"./rc-dialog-c1e6f2a4.js";import"./rc-table-05142f58.js";import"./throttle-debounce-87e7e444.js";import"./rc-checkbox-e1f723bc.js";import"./rc-tree-4f6d91ab.js";import"./@ctrl-fb5a5473.js";import"./rc-pagination-e0bf0fee.js";import"./rc-picker-065f3864.js";import"./rc-dropdown-fec0a85b.js";import"./rc-tooltip-8bc00eb7.js";import"./rc-input-315cad23.js";import"./rc-textarea-ef9e4e31.js";import"./@emotion-c0b5c018.js";import"./stylis-fad5b415.js";(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))C(m);new MutationObserver(m=>{for(const j of m)if(j.type==="childList")for(const S of j.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&C(S)}).observe(document,{childList:!0,subtree:!0});function f(m){const j={};return m.integrity&&(j.integrity=m.integrity),m.referrerPolicy&&(j.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?j.credentials="include":m.crossOrigin==="anonymous"?j.credentials="omit":j.credentials="same-origin",j}function C(m){if(m.ep)return;m.ep=!0;const j=f(m);fetch(m.href,j)}})();const R=le.create({baseURL:"https://apartment-server.wangminan.me",paramsSerializer:n=>nt.stringify(n,{arrayFormat:"brackets"})});R.interceptors.request.use(n=>(window.localStorage.getItem("token")!==void 0&&(n.headers.Authorization="Bearer "+window.localStorage.getItem("token")),n),n=>Promise.reject(n));R.interceptors.response.use(n=>(n!==null&&n.data!==null&&n.data.code!==null&&(n.data.code===4012||n.data.code===4010||n.data.code===4030)&&(window.localStorage.removeItem("token"),setTimeout(()=>{window.location.href="/login"},3e3)),n),n=>Promise.reject(n));const dt=`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5vwYRBKySNSl/60qRqcD
lDVcNP9j2UyB7yalGI9MtlBEZ16pEiR08TuZjUL00go5LEb6z+ghVlp6UOsWR6i3
r7Q+FleKHG2yStqqaWx+11OQzOjffXQwqb1t/0bq/tzy04KBinSaB/yqnMc0yO8n
rZx8OtUX5rMcM7BjvpFOdnCSFUAOOfKRirfT5RydyGeLPOnBTwJIwpygGu20++UX
MxARO1aAJeUXeI+9g+XcsAi1EKbI2YdjWJ8PQnBC9+lsDRS3w8uKqUOZdYu/FxAy
bEjQ+YOXzfu2PB9+BdilkztV/yuF6hfk7MpGdA2JoBsJlljSYWH1mUE+e9mnUyHi
/wIDAQAB`;function ct(n){const b=new st;return b.setPublicKey(dt),b.encrypt(n)}function mt(n){const b="13777864454",f="root",[C,m]=u.useState(b),[j,S]=u.useState(f),[A,U]=u.useState(!1);function w(r){m(()=>r.target.value)}function a(r){S(()=>r.target.value)}function k(){U(!0),R({method:"POST",url:"/api/auth/login/password",data:{username:C,password:ct(j)}}).then(r=>{const{code:d,result:o}=r.data;if(d===2e3)if(window.localStorage.setItem("token",o.token),window.localStorage.setItem("role",o.role),o.user)o.user,n.login(o.role,o.user);else{const c=o.admin;window.localStorage.setItem("user.id",c.id),window.localStorage.setItem("user.name",c.name),window.localStorage.setItem("user.loginAccountId",c.loginAccountId),window.localStorage.setItem("user.email",c.email),n.login(o.role,o.admin)}else{const{msg:c}=r.data;S(""),alert(c)}U(!1)})}return e.jsxs("div",{children:[e.jsx(_,{value:C,onChange:w,placeholder:"Enter your username",prefix:e.jsx(Be,{className:"site-form-item-icon"}),suffix:e.jsx(Pe,{title:"Extra information",children:e.jsx(lt,{style:{color:"rgba(0,0,0,.45)"}})})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(_.Password,{value:j,onChange:a,placeholder:"input password",iconRender:r=>r?e.jsx(be,{}):e.jsx(Ie,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(T,{size:"large",type:"primary",loading:A,onClick:k,children:"Login"})]})}function ut(){const[n,b]=u.useState(""),[f,C]=u.useState(""),[m,j]=u.useState(""),[S,A]=u.useState("");function U(d){b(()=>d.target.value)}function w(d,o){A(o!==""&&d!==o?()=>"error":()=>"")}function a(d){C(()=>d.target.value),w(d.target.value,m)}function k(d){j(()=>d.target.value),w(f,d.target.value)}function r(d){f!==m&&alert("")}return e.jsxs("div",{children:[e.jsx(_,{onChange:U,placeholder:"default size",prefix:e.jsx(Be,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(_.Password,{onChange:a,placeholder:"input password",iconRender:d=>d?e.jsx(be,{}):e.jsx(Ie,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(_.Password,{status:S,onChange:k,placeholder:"password again",iconRender:d=>d?e.jsx(be,{}):e.jsx(Ie,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(T,{size:"large",type:"primary",onClick:r,children:"SignUP"})]})}const ht=""+new URL("apartment-d819f74c.svg",import.meta.url).href;function ee(n){const{routers:b}=n,f=De();function C(m){f("/home"+b[parseInt(m.key,10)-1].route,{replace:!0})}return e.jsx("div",{children:e.jsx("div",{children:e.jsx(rt,{mode:n.mode,theme:n.theme,items:n.textitem,onClick:C})})})}function te(n){return e.jsx(Pe,{placement:"right",title:"先生/女士",children:e.jsxs("span",{children:["欢迎您，",n.job," ",n.usermsg]})})}function xt(n){const{tableitems:b,openAddDrawer:f,tabletype:C,addMsg:m,addfun:j}=n,[S,A]=u.useState(!1),[U,w]=u.useState(!1),[a,k]=u.useState("请在下方补全需要添加的条目 "),r=()=>{k(c=>c+m),f(),A(!0)},d=()=>{w(!0),j(),w(!1)},o=()=>{A(!1)};return e.jsxs("div",{children:[e.jsx(T,{type:"primary",onClick:r,children:"增加条目"}),e.jsxs(at,{title:C,open:S,onOk:d,okText:"提交",confirmLoading:U,onCancel:o,cancelText:"关闭",children:[e.jsx("p",{children:a}),b]})]})}function ge(n){const{checkonly:b}=n,{tableitems:f,openAddDrawer:C,addMsg:m,addfun:j}=n,{getApart:S,getRoom:A,getBed:U}=n;let{tabletype:w,columns:a,tabledata:k,tablepage:r,tabletitle:d}=n;const[o,c]=u.useState(!1);ae.subscribe("tablereturned",(z,O)=>{c(()=>O)});const[,x]=Te.useState(),h=Te.useCallback(()=>x({}),[]);return u.useEffect(()=>{w==="apart"?(c(!1),S(1,100),h()):w==="room"?(c(!1),A(1,100),h()):w==="bed"&&(c(!1),U(1,100))},[w]),o?b?e.jsx("div",{children:e.jsxs(H,{direction:"vertical",size:16,children:[e.jsx("h2",{children:d}),e.jsx(Le,{columns:a,dataSource:k,pagination:!1})]})}):(ae.subscribe("tablepage",(z,O)=>{r=O}),e.jsx("div",{children:e.jsxs(H,{direction:"vertical",size:16,children:[e.jsx("h2",{children:d}),e.jsx(xt,{openAddDrawer:C,tableitems:f,tabletype:w,addMsg:m,addfun:j}),e.jsx(Le,{columns:a,dataSource:k,pagination:!1})]})})):e.jsx("div",{children:e.jsx(Ee,{})})}function Oe(n){const{type:b,transdata:f,send:C}=n,[m,j]=u.useState([]),[S,A]=u.useState([]),[U,w]=u.useState("");function a(){let c=[];for(let x=0;x<m.length;x++)for(let h=0;h<f.length;h++)m[x]===f[h].key&&c.push(f[h].id);C(c,U,b),w("")}function k(c){w(c.target.value)}const r=(c,x,h)=>{j(c)},d=(c,x)=>{A([...c,...x])},o=(c,x)=>{};return e.jsxs("div",{className:"transferbox",children:[e.jsx("div",{children:e.jsx(it,{dataSource:f,titles:["用户列表","发送给"],targetKeys:m,selectedKeys:S,onChange:r,onSelectChange:d,onScroll:o,render:c=>c.title})}),e.jsx(ot,{showCount:!0,maxLength:4096,style:{height:120,resize:"none"},onChange:k,placeholder:"请在此键入发信内容",value:U}),e.jsx(T,{onClick:a,children:"发送"})]})}function pt(n){const[b,f]=u.useState([]),[C,m]=u.useState([]),{lognum:j,userid:S}=n;u.useEffect(()=>{le.defaults.baseURL="https://apartment-server.wangminan.me",U(1,100),w(1,100)},[]);function A(a,k,r){r==="user"?R({method:"POST",url:"/api/message/sender/send",data:{senderAdminId:S,receiverAdminIds:[],receiverUserIds:a,message:k}}).then(d=>{const{code:o,msg:c}=d.data;alert(o===2e3?"发送成功":c)}):r==="admin"?R({method:"POST",url:"/api/message/sender/send",data:{senderAdminId:S,receiverAdminIds:a,receiverUserIds:[],message:k}}).then(d=>{const{code:o,msg:c}=d.data;alert(o===2e3?"发送成功":c)}):alert("发送对象非法")}function U(a,k){R({method:"GET",url:`/api/user/user?pageNum=${a}&pageSize=${k}`}).then(r=>{const{code:d}=r.data;if(d===2e3){const{list:o}=r.data.result;let c=[];for(let x=0;x<o.length;x++){let h={};h.key=V(),h.title=o[x].name,h.name=o[x].name,h.id=o[x].id,h.loginAccountId=o[x].loginAccountId,h.personalId=o[x].personalId,c.push(h)}f(c)}else{const{msg:o}=r.data;alert(o)}})}function w(a,k){R({method:"GET",url:`/api/user/admin?pageNum=${a}&pageSize=${k}`}).then(r=>{const{code:d}=r.data;if(d===2e3){const{list:o}=r.data.result;let c=[];for(let x=0;x<o.length;x++){let h={};h.key=V(),h.title=o[x].name,h.name=o[x].name,h.id=o[x].id,h.loginAccountId=o[x].loginAccountId,h.departmentId=o[x].departmentId,h.email=o[x].email,c.push(h)}m(c)}else{const{msg:o}=r.data;alert(o)}})}return e.jsxs("div",{children:[e.jsx("h1",{children:"催收信发送"}),e.jsx("h3",{children:"发送给用户"}),e.jsx(Oe,{type:"user",transdata:b,send:A}),e.jsx("h3",{children:"发送给管理员"}),e.jsx(Oe,{type:"admin",transdata:C,send:A})]})}function ne(){u.useState(!1),u.useEffect(()=>{le.defaults.baseURL="https://apartment-server.wangminan.me",n(1,100)},[]);function n(b,f){R({method:"GET",url:`/api/message/receiver/inbox?pageNum=${b}&pageSize=${f}`}).then(C=>{const{code:m,result:j}=C.data;if(m!==2e3){const{msg:S}=C.data;alert(S)}})}return e.jsx("div",{})}const se={textAlign:"center",minHeight:120,lineHeight:"120px",color:"#000",backgroundColor:"#eee"},re={textAlign:"center",lineHeight:"120px"};function ft(n){const{logOut:b}=n,{openAddDrawer:f,tableitems:C}=n,{apartAdd:m,roomAdd:j,bedAdd:S}=n,{getApart:A,getRoom:U,getBed:w}=n,{lognum:a,userid:k,textitem:r,usermsg:d,columns:o,tabledata:c,tablepage:x,tabletitle:h}=n,z=r[a].routers,[O,$]=u.useState(!1);function P(){b()}if(a===1)return e.jsx(H,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(E,{style:{minHeight:"100vh"},children:[e.jsx(X,{style:re,collapsible:!0,collapsed:O,onCollapse:L=>$(L),children:e.jsx(ee,{mode:"inline",theme:"dark",textitem:r[a].item,routers:z})}),e.jsxs(E,{children:[e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(B,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ne,{})}),e.jsx(B,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(T,{onClick:P,children:"LogOut"})})]})}),e.jsx(Z,{style:se,children:e.jsxs(Q,{children:[e.jsx(F,{path:"/home/welcome",element:e.jsx(te,{job:r[a].name,usermsg:d})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/home/welcome"})})]})})]})]})});if(a===2)return e.jsx(H,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(E,{style:{minHeight:"100vh"},children:[e.jsx(X,{style:re,collapsible:!0,collapsed:O,onCollapse:L=>$(L),children:e.jsx(ee,{mode:"inline",theme:"dark",textitem:r[a].item,routers:z})}),e.jsxs(E,{children:[e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(B,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ne,{})}),e.jsx(B,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(T,{onClick:P,children:"LogOut"})})]})}),e.jsx(Z,{style:se,children:e.jsxs(Q,{children:[e.jsx(F,{path:"/home/welcome",element:e.jsx(te,{job:r[a].name,usermsg:d})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/home/welcome"})})]})})]})]})});if(a===3)return e.jsx(H,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(E,{style:{minHeight:"100vh"},children:[e.jsx(X,{style:re,collapsible:!0,collapsed:O,onCollapse:L=>$(L),children:e.jsx(ee,{mode:"inline",theme:"dark",textitem:r[a].item,routers:z})}),e.jsxs(E,{children:[e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(B,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ne,{})}),e.jsx(B,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(T,{onClick:P,children:"LogOut"})})]})}),e.jsx(Z,{style:se,children:e.jsxs(Q,{children:[e.jsx(F,{path:"/home/welcome",element:e.jsx(te,{job:r[a].name,usermsg:d})}),e.jsx(F,{path:"/home/apart",element:e.jsx(ge,{tableitems:C,openAddDrawer:()=>f("apart"),addMsg:r[a].addmessages.apart,addfun:m,getApart:A,tabletype:"apart",columns:o,tabledata:c,tablepage:x,tabletitle:h})}),e.jsx(F,{path:"/home/room",element:e.jsx(ge,{tableitems:C,openAddDrawer:()=>f("room"),addMsg:r[a].addmessages.room,addfun:j,getRoom:U,tabletype:"room",columns:o,tabledata:c,tablepage:x,tabletitle:h})}),e.jsx(F,{path:"/home/bed",element:e.jsx(ge,{tableitems:C,openAddDrawer:()=>f("bed"),addMsg:r[a].addmessages.bed,addfun:S,getBed:w,tabletype:"bed",columns:o,tabledata:c,tablepage:x,tabletitle:h})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/home/welcome"})})]})})]})]})});if(a===4)return e.jsx(H,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(E,{style:{minHeight:"100vh"},children:[e.jsx(X,{style:re,collapsible:!0,collapsed:O,onCollapse:L=>$(L),children:e.jsx(ee,{mode:"inline",theme:"dark",textitem:r[a].item,routers:z})}),e.jsxs(E,{children:[e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(B,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ne,{})}),e.jsx(B,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(T,{onClick:P,children:"LogOut"})})]})}),e.jsx(Z,{style:se,children:e.jsxs(Q,{children:[e.jsx(F,{path:"/home/welcome",element:e.jsx(te,{job:r[a].name,usermsg:d})}),e.jsx(F,{path:"/home/collectmsg",element:e.jsx(pt,{lognum:a,userid:k})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/home/welcome"})})]})})]})]})});if(a===5)return e.jsx(H,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(E,{style:{minHeight:"100vh"},children:[e.jsx(X,{style:re,collapsible:!0,collapsed:O,onCollapse:L=>$(L),children:e.jsx(ee,{mode:"inline",theme:"dark",textitem:r[a].item,routers:z})}),e.jsxs(E,{children:[e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(B,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ne,{})}),e.jsx(B,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(T,{onClick:P,children:"LogOut"})})]})}),e.jsx(Z,{style:se,children:e.jsxs(Q,{children:[e.jsx(F,{path:"/home/welcome",element:e.jsx(te,{job:r[a].name,usermsg:d})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/home/welcome"})})]})})]})]})});if(a===6)return e.jsx(H,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(E,{style:{minHeight:"100vh"},children:[e.jsx(X,{style:re,collapsible:!0,collapsed:O,onCollapse:L=>$(L),children:e.jsx(ee,{mode:"inline",theme:"dark",textitem:r[a].item,routers:z})}),e.jsxs(E,{children:[e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(B,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ne,{})}),e.jsx(B,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(T,{onClick:P,children:"LogOut"})})]})}),e.jsx(Z,{style:se,children:e.jsxs(Q,{children:[e.jsx(F,{path:"/home/welcome",element:e.jsx(te,{job:r[a].name,usermsg:d})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/home/welcome"})})]})})]})]})});if(a===7)return e.jsx(H,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(E,{style:{minHeight:"100vh"},children:[e.jsx(X,{style:re,collapsible:!0,collapsed:O,onCollapse:L=>$(L),children:e.jsx(ee,{mode:"inline",theme:"dark",textitem:r[a].item,routers:z})}),e.jsxs(E,{children:[e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(B,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ne,{})}),e.jsx(B,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(T,{onClick:P,children:"LogOut"})})]})}),e.jsx(Z,{style:se,children:e.jsxs(Q,{children:[e.jsx(F,{path:"/home/welcome",element:e.jsx(te,{job:r[a].name,usermsg:d})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/home/welcome"})})]})})]})]})})}function jt(n){const{apartUpdate:b,roomUpdate:f,bedUpdate:C}=n,{type:m,title:j,placement:S,onClose:A,open:U,tableitems:w,records:a}=n,[k,r]=u.useState(!1),[d,o]=u.useState(0),[c,x]=u.useState({status:0});function h(){r(!0),b(a.index,c),r(!1)}function z(P){x(L=>(L.status=P.target.value,L)),o(P.target.value)}function O(){r(!0),f(a.index),r(!1)}function $(){r(!0),C(a.index),r(!1)}if(w.length===0)return e.jsx(he,{title:j,placement:S,onClose:A,open:U,children:e.jsx(Ee,{})});if(m==="apart")return e.jsxs(he,{title:j,placement:S,onClose:A,open:U,children:[w,"此公寓",e.jsxs(oe.Group,{onChange:z,value:d,children:[e.jsx(oe,{value:0,children:"正常使用"}),e.jsx(oe,{value:1,children:"启用中"}),e.jsx(oe,{value:2,children:"弃用中"}),e.jsx(oe,{value:3,children:"已弃用"})]}),e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(T,{type:"primary",loading:k,onClick:h,children:"修改"})})]});if(m==="room")return e.jsxs(he,{title:j,placement:S,onClose:A,open:U,children:[w,e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(T,{type:"primary",loading:k,onClick:O,children:"修改"})})]});if(m==="bed")return e.jsxs(he,{title:j,placement:S,onClose:A,open:U,children:[w,e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(T,{type:"primary",loading:k,onClick:$,children:"修改"})})]})}function M(n,b,f,C,m){return{key:b,icon:f,children:C,label:n,type:m}}const gt=[{},{id:1,name:"超级管理员",item:[M("管理员账号管理","1",e.jsx(D,{})),M("外部单位管理","2",e.jsx(D,{})),M("公寓管理","3",e.jsx(D,{})),M("房间管理","4",e.jsx(D,{}))]},{id:2,name:"入住办理员",item:[M("入住申请审核","1",e.jsx(D,{})),M("床位编号录入","2",e.jsx(D,{})),M("人脸录入确认","3",e.jsx(D,{}))]},{id:3,name:"宿舍调配员",item:[M("住/调宿申请","1",e.jsx(D,{})),M("公寓管理","2",e.jsx(D,{})),M("房间管理","3",e.jsx(D,{})),M("床位管理","4",e.jsx(D,{}))],routers:[{route:"/promise"},{route:"/apart"},{route:"/room"},{route:"/bed"}],addmessages:{apart:"name为公寓名 position为公寓地址 location为经纬度地址",room:"name为宿舍号 sex为性别，应填写“男”或“女” usage为宿舍用途 type为房间种类，应填写“n人间”，n为整数 isForCadre为干部房标识，应填写“是”或“否” isReserved代表此房间是否保留，应填写“是”或“否” totalFee为宿舍费用 selfPayFee为自费费用 refundFee为单位报销费用 ",bed:"name为床位名 roomId为床位所在的宿舍号 receiptId为押金收据单号 isInUse代表床位是否已被占用，应填写“是”或“否” "}},{id:4,name:"财务管理员",item:[M("缴费统计表","1",e.jsx(D,{})),M("催收信","2",e.jsx(D,{})),M("宿舍情况查询","3",e.jsx(D,{}))],routers:[{route:"/paylist"},{route:"/collectmsg"},{route:"/roomchexk"}]}];function yt(){const[n,b]=u.useState(!1),[f,C]=u.useState(0),[m,j]=u.useState(null),[S,A]=u.useState(""),[U,w]=u.useState([]),[a,k]=u.useState([]),[r,d]=u.useState(0),[o,c]=u.useState(""),[x,h]=u.useState(!1),[z,O]=u.useState(""),[$,P]=u.useState({}),[L,de]=u.useState([]),[Ce,ve]=u.useState([]),[p,ie]=u.useState({}),[It,K]=u.useState([]),[Me,we]=u.useState(""),[ze,Ct]=u.useState(null),[vt,xe]=u.useState(!1);De(),u.useEffect(()=>{le.defaults.baseURL="https://apartment-server.wangminan.me",le.get("/api/auth/hello")},[]);const Se=[{title:"Name",dataIndex:"name",key:"name"},{title:"Position",dataIndex:"position",key:"position"},{title:"Location",dataIndex:"location",key:"location"},{title:"Action",key:"action",render:(s,t,i)=>e.jsxs(H,{size:"middle",children:[e.jsx(T,{type:"primary",onClick:()=>fe(i,t,"apart"),children:"修改此条目"}),e.jsxs(T,{type:"primary",onClick:()=>qe(i),children:["删除",t.name]})]})}];function pe(s){de(()=>{let t=[];for(let i=0;i<s.length-1;i++)t.push(s[i].dataIndex);return t}),de(t=>t)}function Ne(s){ie(()=>(p[s.target.id]=s.target.value,p))}function fe(s,t,i){we(()=>i),P(t),h(!0),O(()=>"修改第"+(s+1)+"条"),de(v=>(P(I=>(ve(()=>{let y=[];for(let N=0;N<v.length;N++)y.push(e.jsxs("div",{children:[e.jsx("p",{children:v[N]}),e.jsx(_,{id:v[N],onChange:Ne,defaultValue:I[v[N]]})]},V())),ie(q=>(q[v[N]]=I[v[N]],q));return y}),I)),v))}function ke(s){ie(t=>(t[s.target.id]=s.target.value,t))}function Ke(s){we(()=>s),O(()=>"新增"+s+"条目"),de(t=>(P(i=>(ve(()=>{let v=[];for(let I=0;I<t.length;I++)t[I]==="receiptId"||t[I]==="isInUse"||(t[I]==="location"?v.push(e.jsxs("div",{children:[e.jsx("p",{children:t[I]}),e.jsx(_,{id:t[I],onChange:ke,defaultValue:"请输入合法经纬度,以英文逗号分隔"})]},V())):v.push(e.jsxs("div",{children:[e.jsx("p",{children:t[I]}),e.jsx(_,{id:t[I],onChange:ke,defaultValue:""})]},V())));return v}),i)),t))}function Ae(){let s=[];return ie(t=>(s=t.location.split(","),s.length!=2?(alert("Location格式不正确！"),!1):(t.lon0=s[0],t.lon1=s[1],t))),!0}function He(){Ae(),R({method:"POST",url:"/api/management/apartment",data:{foremanAdminId:f,name:p.name,position:p.position,positionLongitude:p.lon1,positionLatitude:p.lon0,status:0}}).then(s=>{const{code:t}=s.data;if(t===2e3)ce(1,100),alert("增加已完成,请刷新页面以查看最新结果");else{const{msg:i}=s.data;alert(i)}})}function $e(s,t){Ae(),K(i=>(R({method:"PUT",url:`/api/management/apartment/${i[s]}`,data:{foremanAdminId:f,name:p.name,position:p.position,positionLongitude:p.lon1,positionLatitude:p.lon0,status:t.status}}).then(v=>{const{code:I}=v.data;if(I===2e3)ce(1,100),alert("修改已完成，请刷新以查看修改结果"),h(!1);else{const{msg:y}=v.data;alert(y),h(!1)}}),i))}function qe(s){K(t=>{R({method:"DELETE",url:`/api/management/apartment/${t[s]}`}).then(i=>{const{code:v}=i.data;if(v===2e3)ce(1,100),alert("删除已完成,请刷新页面以查看最新结果");else{const{msg:I}=i.data;alert(I)}})})}function ce(s,t){R({method:"GET",url:`/api/management/apartment?pageNum=${s}&pageSize=${t}`}).then(i=>{const{code:v,msg:I}=i.data,{list:y,total:N}=i.data.result;if(v===2e3){c("公寓列表"),d(Math.ceil(N/t)),w(Se),pe(Se),K(l=>(l=[],l));let q=[];for(let l=0;l<y.length;l++){K(G=>(G.push(y[l].id),G));let g={};g.key=V(),g.index=l,g.name=y[l].name,g.position=y[l].position,g.location=y[l].location,q.push(g)}k(q),xe(()=>(ae.publish("tablereturned",!0),!0))}else alert(I)})}const Ue=[{title:"宿舍号",dataIndex:"name",key:"name"},{title:"性别",dataIndex:"sex",key:"sex"},{title:"用途",dataIndex:"usage",key:"usage"},{title:"房间规格",dataIndex:"type",key:"type"},{title:"干部房",dataIndex:"isForCadre",key:"isForCadre"},{title:"保留间",dataIndex:"isReserved",key:"isReserved"},{title:"房间总价",dataIndex:"totalFee",key:"totalFee"},{title:"自理部分",dataIndex:"selfPayFee",key:"selfPayFee"},{title:"单位报销",dataIndex:"refundFee",key:"refundFee"},{title:"Action",key:"action",render:(s,t,i)=>e.jsxs(H,{size:"middle",children:[e.jsx(T,{type:"primary",onClick:()=>fe(i,t,"room"),children:"修改此条目"}),e.jsxs(T,{type:"primary",onClick:()=>Je(i),children:["删除",t.name]})]})}];function Fe(){let s=!0;return ie(t=>(t.sex==="man"||t.sex==="男"?t.sex=0:t.sex==="woman"||t.sex==="女"?t.sex=1:(alert("性别格式非法"),s=!1),t.isForCadre==="是"?t.isForCadre=1:t.isForCadre==="否"?t.isForCadre=0:(alert("干部房状态格式非法"),s=!1),t.isReserved==="是"?t.isReserved=1:t.isReserved==="否"?t.isReserved=0:(alert("保留间状态格式非法"),s=!1),t.type==="单人间"?t.type=1:t.type==="双人间"?t.type=2:t.type=parseInt(t.type.substring(0,t.type.indexOf("人"))),parseInt(t.totalFee)!==parseInt(t.selfPayFee)+parseInt(t.refundFee)&&(alert("总价不等于单位报销部分和个人自理部分之和"),console.log("总"+t.totalFee+"B"+t.refundFee+"S"+t.selfPayFee),s=!1),t)),s}function Ge(){Fe()&&R({method:"POST",url:"/api/management/room",data:{apartmentId:1,name:p.name,sex:p.sex,usage:p.usage,isForCadre:p.isForCadre,isReserved:p.isReserved,type:p.type,totalFee:p.totalFee,selfPayFee:p.selfPayFee,refundFee:p.refundFee}}).then(s=>{const{code:t}=s.data;if(t===2e3)me(1,100),alert("增加已完成,请刷新页面以查看最新结果");else{const{msg:i}=s.data;alert(i)}})}function Qe(s){Fe()&&K(t=>(R({method:"PUT",url:`/api/management/room/${t[s]}`,data:{apartmentId:1,name:p.name,sex:p.sex,usage:p.usage,isForCadre:p.isForCadre,isReserved:p.isReserved,type:p.type,totalFee:p.totalFee,selfPayFee:p.selfPayFee,refundFee:p.refundFee}}).then(i=>{const{code:v}=i.data;if(v===2e3)me(1,100),alert("修改已完成，请刷新以查看修改结果"),h(!1);else{const{msg:I}=i.data;alert(I),h(!1)}}),t))}function Je(s){K(t=>{R({method:"DELETE",url:`/api/management/room/${t[s]}`}).then(i=>{const{code:v}=i.data;if(v===2e3)me(1,100),alert("删除已完成,请刷新页面以查看最新结果");else{const{msg:I}=i.data;alert(I)}})})}function me(s,t){R.get("/api/management/room",{params:{pageNum:s,pageSize:t,apartmentId:1,query:"",isForCadre:"",type:""}}).then(i=>{const{code:v,msg:I}=i.data,{list:y,total:N}=i.data.result;if(v===2e3){c("房间列表"),d(Math.ceil(N/t)),d(l=>(ae.publish("tablepage",l),l)),w(Ue),pe(Ue),K(l=>(l=[],l));let q=[];for(let l=0;l<y.length;l++){K(G=>(G.push(y[l].id),G));let g={};g.key=V(),g.index=l,g.name=y[l].name,y[l].sex===0?g.sex="man":y[l].sex===1&&(g.sex="woman"),g.usage=y[l].usage,y[l].type===1?g.type="单人间":y[l].type===2?g.type="双人间":g.type=y[l].type+"人间",y[l].isForCadre?g.isForCadre="是":g.isForCadre="否",y[l].isReserved?g.isReserved="是":g.isReserved="否",g.totalFee=y[l].totalFee,g.selfPayFee=y[l].selfPayFee,g.refundFee=y[l].refundFee,q.push(g)}k(q),xe(()=>(ae.publish("tablereturned",!0),!0))}else alert(I)})}const Re=[{title:"床位名",dataIndex:"name",key:"name"},{title:"所属房间的id",dataIndex:"roomId",key:"roomId"},{title:"押金收据单号",dataIndex:"receiptId",key:"receiptId"},{title:"床位使用情况",dataIndex:"isInUse",key:"isInUse"},{title:"Action",key:"action",render:(s,t,i)=>e.jsxs(H,{size:"middle",children:[e.jsx(T,{type:"primary",onClick:()=>fe(i,t,"bed"),children:"修改此条目"}),e.jsxs(T,{type:"primary",onClick:()=>Ye(i),children:["删除",t.name]})]})}];function Ve(){let s=!0;return ie(t=>(t.isInUse==="是"?t.isInUse=1:t.isInUse==="否"?t.isInUse=0:(alert("床位使用情况格式非法"),s=!1),t)),s}function _e(){R({method:"POST",url:"/api/management/bed",data:{name:p.name,roomId:p.roomId}}).then(s=>{const{code:t}=s.data;if(t===2e3)ue(1,100),alert("增加已完成,请刷新页面以查看最新结果");else{const{msg:i}=s.data;alert(i)}})}function Xe(s){Ve()&&K(t=>(R({method:"PUT",url:`/api/management/bed/${t[s]}`,data:{name:p.name,roomId:p.roomId,receiptId:p.receiptId,isInUse:p.isInUse}}).then(i=>{const{code:v}=i.data;if(v===2e3)ue(1,100),alert("修改已完成，请刷新以查看修改结果"),h(!1);else{const{msg:I}=i.data;alert(I),h(!1)}}),t))}function Ye(s){K(t=>{R({method:"DELETE",url:`/api/management/bed/${t[s]}`}).then(i=>{const{code:v}=i.data;if(v===2e3)ue(1,100),alert("删除已完成,请刷新页面以查看最新结果");else{const{msg:I}=i.data;alert(I)}})})}function ue(s,t){R.get("/api/management/bed",{params:{pageNum:s,pageSize:t,apartmentId:"",query:"",roomId:"",isInUse:""}}).then(i=>{const{code:v,msg:I}=i.data,{list:y,total:N}=i.data.result;if(v===2e3){c("床位列表"),d(Math.ceil(N/t)),d(l=>(ae.publish("tablepage",l),l)),w(Re),pe(Re),K(l=>(l=[],l));let q=[];for(let l=0;l<y.length;l++){K(G=>(G.push(y[l].id),G));let g={};g.key=V(),g.index=l,g.name=y[l].name,g.roomId=y[l].roomId,g.receiptId=y[l].receiptId,y[l].isInUse===1?g.isInUse="是":g.isInUse="否",q.push(g)}k(q),xe(()=>(ae.publish("tablereturned",!0),!0))}else alert(I)})}function We(s,t){b(i=>!0),C(s),A(t.id),j(t.name)}function Ze(){window.localStorage.removeItem("token"),b(!1)}return n?e.jsxs("div",{children:[e.jsx(ft,{lognum:f,userid:S,usermsg:m,textitem:gt,columns:U,tabledata:a,tablepage:r,tabletitle:o,logOut:Ze,getApart:ce,getRoom:me,getBed:ue,openAddDrawer:Ke,addButtons:ze,tableitems:Ce,apartAdd:He,roomAdd:Ge,bedAdd:_e}),e.jsx(jt,{type:Me,title:z,placement:"bottom",onClose:()=>h(!1),open:x,tableitems:Ce,records:$,apartUpdate:$e,roomUpdate:Qe,bedUpdate:Xe})]}):e.jsx("div",{className:"login-box",children:e.jsx("div",{className:"glass",children:e.jsxs("div",{className:"innerlogin",children:[e.jsx("p",{children:"公寓员工管理系统"}),e.jsx("img",{src:ht}),e.jsxs(Q,{children:[e.jsx(F,{path:"/login",element:e.jsx(mt,{login:We})}),e.jsx(F,{path:"/register",element:e.jsx(ut,{})}),e.jsx(F,{path:"*",element:e.jsx(J,{to:"/login"})})]})]})})})}const ye="user_key",bt={saveUser(n){je.set(ye,n)},getUser(){return je.get(ye)||{}},removeUser(){je.remove(ye)}};bt.getUser();et.createRoot(document.getElementById("root")).render(e.jsx(tt,{children:e.jsx(yt,{})}));
