import{r,j as e,R as Ze}from"./react-405f76d8.js";import{c as xt}from"./react-dom-04773658.js";import{B as ft}from"./react-router-dom-d8ab318c.js";import{a as Se}from"./axios-4a70c6fc.js";import{q as jt}from"./qs-b3e11d6e.js";import{J as gt}from"./js-encrypt-af0330d8.js";import{m as ke,I as ae,T as it,B as U,M as yt,a as at,S as Ee,b as te,c as et,d as bt,e as It,D as le,R as E,f as Ie,C as I,g as St,U as wt,L as W,h as pe,H as he,i as xe,j as Ae}from"./antd-c860838a.js";import{U as _e,O as Ct,Q as Ge,m as Qe,T as kt,V as vt,W as Ke,X as tt,Y as Le,Z as nt,_ as st,$ as Tt,a0 as Ut}from"./@ant-design-8ee84b79.js";import{u as Ve,a as de,b as B,N as ce}from"./react-router-345db1d8.js";import{P as ue}from"./pubsub-js-cf81b55e.js";import{v as se}from"./uuid-a960c1f4.js";import{O as At}from"./ali-oss-9a2253aa.js";import{s as $e}from"./store-10531bb0.js";import"./scheduler-765c72db.js";import"./@remix-run-93d98c9a.js";import"./side-channel-86ee5d5c.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-e5c1c8b0.js";import"./object-inspect-2b0f847f.js";import"./rc-util-850552fb.js";import"./@babel-5495bcd4.js";import"./react-is-e8e5dbb3.js";import"./classnames-423472b7.js";import"./rc-resize-observer-c1f7585f.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-motion-3201de9c.js";import"./rc-tabs-0d77b2d0.js";import"./rc-dropdown-708b9c2c.js";import"./@rc-component-936e731d.js";import"./rc-menu-37d51047.js";import"./rc-overflow-ddb4f90e.js";import"./rc-select-cf6958bf.js";import"./rc-virtual-list-ae0a1e4e.js";import"./rc-drawer-99af170c.js";import"./rc-field-form-54e4fc4e.js";import"./async-validator-7f96df71.js";import"./rc-dialog-a74ba1f8.js";import"./rc-notification-74a1f2ae.js";import"./rc-table-cd631858.js";import"./throttle-debounce-87e7e444.js";import"./rc-checkbox-91ed4fc8.js";import"./rc-tree-40c741fd.js";import"./@ctrl-fb5a5473.js";import"./rc-pagination-a2446b27.js";import"./rc-input-bb537b4e.js";import"./rc-textarea-e23bd29b.js";import"./rc-upload-69a575d0.js";import"./rc-picker-33c36620.js";import"./rc-progress-408c3afa.js";import"./rc-tooltip-adb341bc.js";import"./@emotion-c0b5c018.js";import"./stylis-fad5b415.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))y(n);new MutationObserver(n=>{for(const j of n)if(j.type==="childList")for(const w of j.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&y(w)}).observe(document,{childList:!0,subtree:!0});function x(n){const j={};return n.integrity&&(j.integrity=n.integrity),n.referrerPolicy&&(j.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?j.credentials="include":n.crossOrigin==="anonymous"?j.credentials="omit":j.credentials="same-origin",j}function y(n){if(n.ep)return;n.ep=!0;const j=x(n);fetch(n.href,j)}})();const D=Se.create({baseURL:"https://apartment-server.wangminan.me",paramsSerializer:s=>jt.stringify(s,{arrayFormat:"brackets"})});D.interceptors.request.use(s=>(window.localStorage.getItem("token")!==void 0&&(s.headers.Authorization="Bearer "+window.localStorage.getItem("token")),s),s=>Promise.reject(s));D.interceptors.response.use(s=>(s!==null&&s.data!==null&&s.data.code!==null&&(s.data.code===4012||s.data.code===4010||s.data.code===4030)&&(window.localStorage.removeItem("token"),setTimeout(()=>{window.location.href="/login"},3e3)),s),s=>Promise.reject(s));const Pt=`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5vwYRBKySNSl/60qRqcD
lDVcNP9j2UyB7yalGI9MtlBEZ16pEiR08TuZjUL00go5LEb6z+ghVlp6UOsWR6i3
r7Q+FleKHG2yStqqaWx+11OQzOjffXQwqb1t/0bq/tzy04KBinSaB/yqnMc0yO8n
rZx8OtUX5rMcM7BjvpFOdnCSFUAOOfKRirfT5RydyGeLPOnBTwJIwpygGu20++UX
MxARO1aAJeUXeI+9g+XcsAi1EKbI2YdjWJ8PQnBC9+lsDRS3w8uKqUOZdYu/FxAy
bEjQ+YOXzfu2PB9+BdilkztV/yuF6hfk7MpGdA2JoBsJlljSYWH1mUE+e9mnUyHi
/wIDAQAB`;function Ot(s){const u=new gt;return u.setPublicKey(Pt),u.encrypt(s)}function Ft(s){const u="13777864454",x="root",[y,n]=r.useState(u),[j,w]=r.useState(x),[v,a]=r.useState(!1),[S,F]=ke.useMessage();function d(p){n(()=>p.target.value)}function T(p){w(()=>p.target.value)}function o(){a(!0),D({method:"POST",url:"/api/auth/login/password",data:{username:y,password:Ot(j)}}).then(p=>{const{code:g,result:c}=p.data;if(g===2e3)if(window.localStorage.setItem("token",c.token),window.localStorage.setItem("role",c.role),c.user)s.login(c.role,c.user);else{const f=c.admin;window.localStorage.setItem("user.id",f.id),window.localStorage.setItem("user.name",f.name),window.localStorage.setItem("user.loginAccountId",f.loginAccountId),window.localStorage.setItem("user.email",f.email),s.login(c.role,c.admin)}else{const{msg:f}=p.data;w(""),S.error(f)}}).catch(p=>{S.error("登录失败,未知异常:"+p.message)}).finally(()=>{a(!1)})}return e.jsxs("div",{children:[F,e.jsx(ae,{value:y,onChange:d,placeholder:"Enter your username",prefix:e.jsx(_e,{className:"site-form-item-icon"}),suffix:e.jsx(it,{title:"Extra information",children:e.jsx(Ct,{style:{color:"rgba(0,0,0,.45)"}})})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(ae.Password,{value:j,onChange:T,placeholder:"input password",iconRender:p=>p?e.jsx(Ge,{}):e.jsx(Qe,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(U,{size:"large",type:"primary",loading:v,onClick:o,children:"登录"})]})}function Rt(){const[s,u]=r.useState(""),[x,y]=r.useState(""),[n,j]=r.useState(""),[w,v]=r.useState("");function a(o){u(()=>o.target.value)}function S(o,p){v(p!==""&&o!==p?()=>"error":()=>"")}function F(o){y(()=>o.target.value),S(o.target.value,n)}function d(o){j(()=>o.target.value),S(x,o.target.value)}function T(o){x!==n&&alert("")}return e.jsxs("div",{children:[e.jsx(ae,{onChange:a,placeholder:"default size",prefix:e.jsx(_e,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(ae.Password,{onChange:F,placeholder:"input password",iconRender:o=>o?e.jsx(Ge,{}):e.jsx(Qe,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(ae.Password,{status:w,onChange:d,placeholder:"password again",iconRender:o=>o?e.jsx(Ge,{}):e.jsx(Qe,{})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(U,{size:"large",type:"primary",onClick:T,children:"SignUP"})]})}const Dt=""+new URL("apartment-d819f74c.svg",import.meta.url).href;function fe(s){const{routers:u}=s,x=Ve();function y(n){x("/home"+u[parseInt(n.key,10)-1].route,{replace:!0})}return e.jsx("div",{children:e.jsx("div",{children:e.jsx(yt,{mode:s.mode,theme:s.theme,items:s.textitem,onClick:y})})})}function je(s){return e.jsx(it,{placement:"right",title:"先生/女士",children:e.jsxs("span",{children:["欢迎您，",s.job," ",s.usermsg]})})}function Lt(s){const{tableitems:u,openAddDrawer:x,tabletype:y,addMsg:n,addfun:j}=s,[w,v]=r.useState(!1),[a,S]=r.useState(!1),[F,d]=r.useState("请在下方补全需要添加的条目 "),T=()=>{d(g=>g+n),x(),v(!0)},o=()=>{S(!0),j(),S(!1)},p=()=>{v(!1)};return e.jsxs("div",{children:[e.jsx(U,{type:"primary",onClick:T,children:"增加条目"}),e.jsxs(at,{title:y,open:w,onOk:o,okText:"提交",confirmLoading:a,onCancel:p,cancelText:"关闭",children:[e.jsx("p",{children:F}),u]})]})}function Pe(s){const{checkonly:u}=s,{tableitems:x,openAddDrawer:y,addMsg:n,addfun:j}=s,{getApart:w,getRoom:v,getBed:a,getOutPay:S}=s;let{tabletype:F,columns:d,tabledata:T,tablepage:o,tabletitle:p}=s;const[g,c]=r.useState(!1);ue.subscribe("tablereturned",(k,H)=>{c(()=>H)});const[,f]=Ze.useState(),A=Ze.useCallback(()=>f({}),[]);if(r.useEffect(()=>{F==="apart"?(c(!1),w(1,100),A()):F==="room"?(c(!1),v(1,100),A()):F==="bed"?(c(!1),a(1,100)):F==="outpay"&&(c(!1),S(1,100))},[F]),g){if(u)return e.jsx("div",{children:e.jsxs(te,{direction:"vertical",size:16,children:[e.jsx("h2",{style:{lineHeight:"30px"},children:p}),e.jsx(et,{columns:d,dataSource:T,pagination:!1})]})})}else return e.jsx("div",{children:e.jsx(Ee,{})});return ue.subscribe("tablepage",(k,H)=>{o=H}),e.jsx("div",{children:e.jsxs(te,{direction:"vertical",size:16,children:[e.jsx("h2",{style:{lineHeight:"30px"},children:p}),e.jsx(Lt,{openAddDrawer:y,tableitems:x,tabletype:F,addMsg:n,addfun:j}),e.jsx(et,{style:{margin:"0 auto 20px auto"},columns:d,dataSource:T,pagination:!1})]})})}function Bt(s){const{type:u,transdata:x,send:y}=s,[n,j]=r.useState([]),[w,v]=r.useState([]),[a,S]=r.useState("");function F(){let g=[];for(let c=0;c<n.length;c++)for(let f=0;f<x.length;f++)n[c]===x[f].key&&g.push(x[f].id);y(g,a,u),S("")}function d(g){S(g.target.value)}const T=(g,c,f)=>{j(g)},o=(g,c)=>{v([...g,...c])},p=(g,c)=>{};return e.jsxs("div",{className:"transferbox",children:[e.jsx("div",{children:e.jsx(bt,{dataSource:x,titles:["用户列表","发送给"],targetKeys:n,selectedKeys:w,onChange:T,onSelectChange:o,onScroll:p,render:g=>g.title})}),e.jsx(It,{showCount:!0,maxLength:4096,style:{marginTop:"5%",width:"80%",height:"120%",resize:"none"},onChange:d,placeholder:"请在此键入发信内容",value:a}),e.jsx(U,{onClick:F,style:{marginTop:"5%"},children:"发送"})]})}function Et(s){const[u,x]=r.useState([]),[y,n]=r.useState([]),{lognum:j,userid:w}=s,[v,a]=ke.useMessage();r.useEffect(()=>{Se.defaults.baseURL="https://apartment-server.wangminan.me",F(1,100),d(1,100)},[]);function S(T,o,p){p==="user"?D({method:"POST",url:"/api/message/sender/send",data:{senderAdminId:w,receiverAdminIds:[],receiverUserIds:T,message:o}}).then(g=>{const{code:c,msg:f}=g.data;c===2e3?v.info("发送成功"):v.info(f)}):p==="admin"?D({method:"POST",url:"/api/message/sender/send",data:{senderAdminId:w,receiverAdminIds:T,receiverUserIds:[],message:o}}).then(g=>{const{code:c,msg:f}=g.data;c===2e3?v.info("发送成功"):v.info(f)}):v.info("发送对象非法")}function F(T,o){D({method:"GET",url:`/api/user/user?pageNum=${T}&pageSize=${o}`}).then(p=>{const{code:g}=p.data;if(g===2e3){const{list:c}=p.data.result;let f=[];for(let A=0;A<c.length;A++){let k={};k.key=se(),k.title=c[A].name,k.name=c[A].name,k.id=c[A].id,k.loginAccountId=c[A].loginAccountId,k.personalId=c[A].personalId,f.push(k)}x(f)}else{const{msg:c}=p.data;v.info(c)}})}function d(T,o){D({method:"GET",url:`/api/user/admin?pageNum=${T}&pageSize=${o}`}).then(p=>{const{code:g}=p.data;if(g===2e3){const{list:c}=p.data.result;let f=[];for(let A=0;A<c.length;A++){let k={};k.key=se(),k.title=c[A].name,k.name=c[A].name,k.id=c[A].id,k.loginAccountId=c[A].loginAccountId,k.departmentId=c[A].departmentId,k.email=c[A].email,f.push(k)}n(f)}else{const{msg:c}=p.data;v.info(c)}})}return e.jsxs("div",{children:[a,e.jsx("h3",{children:"催收信发送-发送给用户"}),e.jsx(Bt,{type:"user",transdata:u,send:S})]})}function ge(){r.useState(!1),r.useEffect(()=>{Se.defaults.baseURL="https://apartment-server.wangminan.me",s(1,100)},[]);function s(u,x){D({method:"GET",url:`/api/message/receiver/inbox?pageNum=${u}&pageSize=${x}`}).then(y=>{const{code:n,result:j}=y.data;if(n!==2e3){const{msg:w}=y.data;alert(w)}})}return e.jsx("div",{})}const Mt=[{title:"床位ID",dataIndex:"id",key:"id"},{title:"床位名",dataIndex:"name",key:"name"},{title:"所属房间的id",dataIndex:"roomId",key:"roomId"},{title:"押金收据单号",dataIndex:"receiptId",key:"receiptId"},{title:"床位使用情况",dataIndex:"isInUse",key:"isInUse"}];function Be(s){const{lognum:u}=s,[x,y]=r.useState(!1),[n,j]=r.useState([{id:"",userId:"",name:"",type:"",applicationStatus:"",depositStatus:"",paymentId:"",createTime:"",updateTime:"",fileUrl:""}]),[w,v]=r.useState([]),[a,S]=r.useState(0),[F,d]=r.useState(!1),[T,o]=r.useState(!1),[p,g]=r.useState(!1),[c,f]=r.useState(""),{tableitems:A,tabledata:k,tablepage:H,tabletitle:K}=s,{getBed:z}=s,[M,Z]=r.useState(!0),[Oe,C]=r.useState(!1),[ee,ve]=ke.useMessage(),V=Ve();r.useEffect(()=>{Se.defaults.baseURL="https://apartment-server.wangminan.me",u===3?re(1,100,"/api/application/apply/status/center"):u===2?re(1,100,"/api/application/apply/status/center/checkin"):u===5?re(1,100,"/api/application/apply/status/apartment"):re(1,100,"/api/application/apply/status/department")},[]);function Me(){let q=[];j(G=>{for(let J=0;J<G.length;J++)q.push(e.jsx(I,{className:"gutter-row",span:8,children:e.jsxs(St,{title:G[J].type+"申请",bordered:!1,children:[e.jsx(L,{title:"ID",content:G[J].id}),e.jsx(L,{title:"Type",content:G[J].type}),e.jsx(L,{title:"ApplicationStatus",content:G[J].applicationStatus}),e.jsx("p",{}),e.jsx(U,{onClick:()=>R(J),children:"查看"})]})}));return v(q),G})}function re(q,G,J){D.get(J,{params:{pageNum:q,pageSize:G}}).then(Ce=>{const{code:ze,result:He}=Ce.data;if(ze===2e3){const{list:N}=He;if(N.length===0){C(!0),PubSub.publish("cardsreturned",!0);return}let Ue=[];for(let $=0;$<N.length;$++){let Q={};Q.key=se(),Q.id=N[$].id,Q.userId=N[$].userId,Q.paymentId=N[$].paymentId,N[$].type===0?Q.type="入住":N[$].type===1?Q.type="调宿":N[$].type===2&&(Q.type="退宿"),Q.fileUrl=N[$].fileUrl,Q.applicationStatus=N[$].applicationStatus,N[$].depositStatus===0?Q.depositStatus="未缴纳":N[$].depositStatus===1?Q.depositStatus="已缴纳":N[$].depositStatus===2&&(Q.depositStatus="已退回"),Q.createTime=N[$].createTime,Q.updateTime=N[$].updateTime,Ue.push(Q)}j(Ue),Me(),PubSub.publish("cardsreturned",!0)}else{const{msg:N}=Ce.data;ee.info(N)}})}function Ne(){o(!0)}function Je(){g(!0),D({method:"POST",url:"/api/application/apply/status/center",data:{id:n[a].id,bedId:c}}).then(q=>{const{code:G}=q.data;if(G===2e3)ee.info("分配完成"),g(!1),re(1,100);else{const{msg:J}=q.data;ee.info(J),g(!1)}})}function Xe(){o(!1)}function we(q){f(q.target.value)}const R=q=>{S(()=>q),y(!0)},oe=()=>{y(!1)};function ie(q){D({method:"POST",url:q,data:{id:n[a].id,pass:M}}).then(G=>{const{code:J}=G.data;if(J===2e3)ee.info("审批完成"),getOtherReview(1,100);else{const{msg:Ce}=G.data;ee.info(Ce)}})}function me(){Z(!0),u===2?ie("/api/application/apply/status/center/checkin"):u===6?ie("/api/application/apply/status/department"):u===5&&ie("/api/application/apply/status/apartment")}function Fe(){Z(!1),u===2?ie("/api/application/apply/status/center/checkin"):u===6?ie("/api/application/apply/status/department"):u===5&&ie("/api/application/apply/status/apartment")}function Te(){V("/home/welcome")}if(PubSub.subscribe("cardsreturned",(q,G)=>{d(G)}),F){if(Oe===!0)return e.jsxs("div",{children:[ve,e.jsx(le,{orientation:"middle",children:"申请页面"}),e.jsx("p",{children:"暂时没有新的申请，休息一下吧"}),e.jsx(U,{onClick:Te,children:"刷新"})]});if(u===3)return e.jsxs("div",{children:[ve,e.jsx(le,{orientation:"middle",children:"申请页面"}),e.jsx(E,{style:{margin:"0 auto"},gutter:[16,20],children:w}),e.jsxs(Ie,{width:640,placement:"right",closable:!1,onClose:oe,open:x,children:[e.jsx("p",{className:"site-description-item-profile-p",style:{marginBottom:24},children:"申请表"}),e.jsx("br",{}),e.jsxs(E,{children:[e.jsx(I,{span:12,children:e.jsx(L,{title:"ID",content:n[a].id})}),e.jsx(I,{span:12,children:e.jsx(L,{title:"UserID",content:n[a].userId})})]}),e.jsxs(E,{children:[e.jsx(I,{span:12,children:e.jsx(L,{title:"Type",content:n[a].type})}),e.jsx(I,{span:12,children:e.jsx(L,{title:"ApplicationStatus",content:n[a].applicationStatus})})]}),e.jsxs(E,{children:[e.jsx(I,{span:24,children:e.jsx(L,{title:"DepositStatus",content:n[a].depositStatus})}),e.jsx(I,{span:24,children:e.jsx(L,{title:"PaymentId",content:n[a].paymentId})})]}),e.jsxs(E,{children:[e.jsx(I,{span:24,children:e.jsx(L,{title:"createTime",content:n[a].createTime})}),e.jsx(I,{span:24,children:e.jsx(L,{title:"updateTime",content:n[a].updateTime})})]}),e.jsx(E,{children:e.jsx(I,{span:24,children:e.jsx("a",{href:n[a].fileUrl,children:"申请详情"})})}),e.jsx(le,{}),e.jsx(U,{onClick:oe,children:"Back"}),e.jsx(U,{type:"primary",onClick:Ne,children:"分配床位"})]}),e.jsxs(at,{title:"Title",open:T,onOk:Je,okText:"提交",confirmLoading:p,onCancel:Xe,cancelText:"关闭",children:[e.jsxs("p",{children:["请在此键入要分配给",n[a].userId,"号用户的床位"]}),e.jsx(ae,{onChange:we}),e.jsx(Pe,{checkonly:!0,tableitems:A,getBed:z,tabletype:"bed",columns:Mt,tabledata:k,tablepage:H,tabletitle:K})]})]});if(u===2)return e.jsxs("div",{children:[ve,e.jsx(le,{orientation:"middle",children:"申请页面"}),e.jsx(E,{style:{margin:"0 auto"},gutter:[16,20],children:w}),e.jsxs(Ie,{width:640,placement:"right",closable:!1,onClose:oe,open:x,children:[e.jsx("p",{className:"site-description-item-profile-p",style:{marginBottom:24},children:"申请表"}),e.jsx("br",{}),e.jsxs(E,{children:[e.jsx(I,{span:12,children:e.jsx(L,{title:"ID",content:n[a].id})}),e.jsx(I,{span:12,children:e.jsx(L,{title:"UserID",content:n[a].userId})})]}),e.jsxs(E,{children:[e.jsx(I,{span:12,children:e.jsx(L,{title:"Type",content:n[a].type})}),e.jsx(I,{span:12,children:e.jsx(L,{title:"ApplicationStatus",content:n[a].applicationStatus})})]}),e.jsxs(E,{children:[e.jsx(I,{span:24,children:e.jsx(L,{title:"DepositStatus",content:n[a].depositStatus})}),e.jsx(I,{span:24,children:e.jsx(L,{title:"PaymentId",content:n[a].paymentId})})]}),e.jsxs(E,{children:[e.jsx(I,{span:24,children:e.jsx(L,{title:"createTime",content:n[a].createTime})}),e.jsx(I,{span:24,children:e.jsx(L,{title:"updateTime",content:n[a].updateTime})})]}),e.jsx(E,{children:e.jsx(I,{span:24,children:e.jsx("a",{href:n[a].fileUrl,children:"申请详情"})})}),e.jsx(le,{}),e.jsx(U,{onClick:oe,children:"Back"}),e.jsx(U,{type:"primary",onClick:me,children:"批准"}),e.jsx(U,{onClick:Fe,children:"驳回"})]})]});if(u===6||u===5)return e.jsxs("div",{children:[ve,e.jsx(le,{orientation:"middle",children:"申请页面"}),e.jsx(E,{style:{margin:"0 auto"},gutter:[16,20],children:w}),e.jsxs(Ie,{width:640,placement:"right",closable:!1,onClose:oe,open:x,children:[e.jsx("p",{className:"site-description-item-profile-p",style:{marginBottom:24},children:"申请表"}),e.jsx("br",{}),e.jsxs(E,{children:[e.jsx(I,{span:12,children:e.jsx(L,{title:"ID",content:n[a].id})}),e.jsx(I,{span:12,children:e.jsx(L,{title:"UserID",content:n[a].userId})})]}),e.jsxs(E,{children:[e.jsx(I,{span:12,children:e.jsx(L,{title:"Type",content:n[a].type})}),e.jsx(I,{span:12,children:e.jsx(L,{title:"ApplicationStatus",content:n[a].applicationStatus})})]}),e.jsxs(E,{children:[e.jsx(I,{span:24,children:e.jsx(L,{title:"DepositStatus",content:n[a].depositStatus})}),e.jsx(I,{span:24,children:e.jsx(L,{title:"PaymentId",content:n[a].paymentId})})]}),e.jsxs(E,{children:[e.jsx(I,{span:24,children:e.jsx(L,{title:"createTime",content:n[a].createTime})}),e.jsx(I,{span:24,children:e.jsx(L,{title:"updateTime",content:n[a].updateTime})})]}),e.jsx(E,{children:e.jsx(I,{span:24,children:e.jsx("a",{href:n[a].fileUrl,children:"申请详情"})})}),e.jsx(le,{}),e.jsx(U,{onClick:oe,children:"Back"}),e.jsx(U,{type:"primary",onClick:me,children:"批准"}),e.jsx(U,{onClick:Fe,children:"驳回"})]})]})}else return e.jsxs("div",{children:[e.jsx(le,{orientation:"middle",children:"申请页面"}),e.jsx(Ee,{})]})}const L=({title:s,content:u})=>e.jsxs("div",{className:"site-description-item-profile-wrapper",children:[e.jsxs("p",{className:"site-description-item-profile-p-label",children:[s,":"]}),u]});function Nt(s){const[u,x]=r.useState(""),[y,n]=r.useState(!1),[j,w]=r.useState(""),[v,a]=r.useState(!1),{getOutPay:S}=s,{tabletype:F,columns:d,tabledata:T,tablepage:o,tabletitle:p,tableitems:g}=s;r.useState(!1);const[c,f]=ke.useMessage();r.useEffect(()=>{Se.defaults.baseURL="https://apartment-server.wangminan.me",S(1,100),A(),k()},[]);function A(){D({method:"GET",url:"/api/finance/center/withhold/download"}).then(z=>{const{code:M}=z.data;if(M===2e3){const{result:Z}=z.data;x(Z),n(!0)}else{const{msg:Z}=z.data;c.info(Z)}})}function k(){D({method:"GET",url:"/api/finance/center/charge/download"}).then(z=>{const{code:M}=z.data;if(M===2e3){const{result:Z}=z.data;w(Z),a(!0)}else{const{msg:Z}=z.data;c.info(Z)}})}function H(){window.open(u)}function K(){window.open(j)}return y&&v?e.jsxs("div",{children:[f,e.jsx(U,{onClick:H,children:"下载外部单位代扣表"}),e.jsx(Pe,{tableitems:g,checkonly:!0,tabletype:"outpay",getOutPay:S,columns:d,tabledata:T,tablepage:o,tabletitle:p}),e.jsx("br",{}),e.jsx(U,{onClick:K,children:"下载自收表"})]}):e.jsx("div",{children:e.jsx(Ee,{})})}const zt={"x-oss-storage-class":"Standard","x-oss-object-acl":"public-read","x-oss-forbid-overwrite":"true"},Ht=()=>{function s(){return((1+window.crypto.getRandomValues(new Uint32Array(1))[0])*65536|0).toString(16).substring(1)}return`${+new Date}_${s()}${s()}`},Kt=async()=>await D.get("https://sts.wangminan.me/oss"),$t=async(s,u,x)=>{const y=await Kt();return await new At({endpoint:"oss-cn-shanghai.aliyuncs.com",accessKeyId:y.data.AccessKeyId,accessKeySecret:y.data.AccessKeySecret,stsToken:y.data.SecurityToken,bucket:"wangminan-shanghai-files",useFetch:!0,secure:!0,refreshSTSToken:async()=>{const j=await D.get("https://sts.wangminan.me/oss");return{accessKeyId:j.AccessKeyId,accessKeySecret:j.AccessKeySecret,stsToken:j.SecurityToken}}}).put(s+u+"_"+Ht()+"."+x.name.split(".")[1],x,{headers:zt})};function qt(){const[s,u]=r.useState([]),[x,y]=r.useState(!1),[n,j]=ke.useMessage(),w=async()=>{try{if(y(!0),s[0].size>10*1024*1024){n.error("照片过大，请进行压缩");return}const a=await $t("apartment/user/face/","人脸识别",s[0]);D.get("/api/auth/face/user",{params:{faceUrl:a.url}}).then(S=>{if(S.data.code===2e3){const d=S.data.user.name,T=S.data.user.bedId;n.info("人脸识别成功！"),n.info("此人是："+d+",床位号："+T)}else{const{msg:d}=S.data;n.info("非法闯入，此人不存在"),console.log(d)}})}catch(a){console.log(a)}finally{y(!1)}},v={onRemove:a=>{const S=s.indexOf(a),F=s.slice();F.splice(S,1),u(F)},beforeUpload:a=>(u([...s,a]),!1),fileList:s};return e.jsxs("div",{children:[j,e.jsx(wt,{...v,children:e.jsx(U,{icon:e.jsx(kt,{}),children:"请选择人脸图片"})}),e.jsx(U,{type:"primary",onClick:w,disabled:s.length===0,loading:x,style:{marginTop:16},children:x?"人脸识别中":"上传人脸"})]})}const ye={textAlign:"center",minHeight:120,lineHeight:"120px",color:"#000",backgroundColor:"#eee"},be={textAlign:"center",lineHeight:"120px"};function Gt(s){const{logOut:u}=s,{openAddDrawer:x,tableitems:y}=s,{apartAdd:n,roomAdd:j,bedAdd:w}=s,{getApart:v,getRoom:a,getBed:S,getOutPay:F}=s,{lognum:d,userid:T,textitem:o,usermsg:p,columns:g,tabledata:c,tablepage:f,tabletitle:A}=s,k=o[d].routers,[H,K]=r.useState(!1);function z(){u()}if(d===1)return e.jsx(te,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(W,{style:{minHeight:"100vh"},children:[e.jsx(pe,{style:be,collapsible:!0,collapsed:H,onCollapse:M=>K(M),children:e.jsx(fe,{mode:"inline",theme:"dark",textitem:o[d].item,routers:k})}),e.jsxs(W,{children:[e.jsx(he,{style:{backgroundColor:"#409eff"},children:e.jsxs(E,{style:{height:"100%"},children:[e.jsx(I,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ge,{})}),e.jsx(I,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"退出"})})]})}),e.jsx(xe,{style:ye,children:e.jsxs(de,{children:[e.jsx(B,{path:"/home/welcome",element:e.jsx(je,{job:o[d].name,usermsg:p})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/home/welcome"})})]})})]})]})});if(d===2)return e.jsx(te,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(W,{style:{minHeight:"100vh"},children:[e.jsx(pe,{style:be,collapsible:!0,collapsed:H,onCollapse:M=>K(M),children:e.jsx(fe,{mode:"inline",theme:"dark",textitem:o[d].item,routers:k})}),e.jsxs(W,{children:[e.jsx(he,{style:{backgroundColor:"#409eff"},children:e.jsxs(E,{style:{height:"100%"},children:[e.jsx(I,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ge,{})}),e.jsx(I,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"退出"})})]})}),e.jsx(xe,{style:ye,children:e.jsxs(de,{children:[e.jsx(B,{path:"/home/welcome",element:e.jsx(je,{job:o[d].name,usermsg:p})}),e.jsx(B,{path:"/home/checkin",element:e.jsx(Be,{lognum:d})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/home/welcome"})})]})})]})]})});if(d===3)return e.jsx(te,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(W,{style:{minHeight:"100vh"},children:[e.jsx(pe,{style:be,collapsible:!0,collapsed:H,onCollapse:M=>K(M),children:e.jsx(fe,{mode:"inline",theme:"dark",textitem:o[d].item,routers:k})}),e.jsxs(W,{children:[e.jsx(he,{style:{backgroundColor:"#409eff"},children:e.jsxs(E,{style:{height:"100%"},children:[e.jsx(I,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ge,{})}),e.jsx(I,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"退出"})})]})}),e.jsx(xe,{style:ye,children:e.jsxs(de,{children:[e.jsx(B,{path:"/home/welcome",element:e.jsx(je,{job:o[d].name,usermsg:p})}),e.jsx(B,{path:"/home/promise",element:e.jsx(Be,{lognum:d,tableitems:y,getBed:S,tabletype:"bed",columns:g,tabledata:c,tablepage:f,tabletitle:A})}),e.jsx(B,{path:"/home/apart",element:e.jsx(Pe,{tableitems:y,openAddDrawer:()=>x("apart"),addMsg:o[d].addmessages.apart,addfun:n,getApart:v,tabletype:"apart",columns:g,tabledata:c,tablepage:f,tabletitle:A})}),e.jsx(B,{path:"/home/room",element:e.jsx(Pe,{tableitems:y,openAddDrawer:()=>x("room"),addMsg:o[d].addmessages.room,addfun:j,getRoom:a,tabletype:"room",columns:g,tabledata:c,tablepage:f,tabletitle:A})}),e.jsx(B,{path:"/home/bed",element:e.jsx(Pe,{tableitems:y,openAddDrawer:()=>x("bed"),addMsg:o[d].addmessages.bed,addfun:w,getBed:S,tabletype:"bed",columns:g,tabledata:c,tablepage:f,tabletitle:A})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/home/welcome"})})]})})]})]})});if(d===4)return e.jsx(te,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(W,{style:{minHeight:"100vh"},children:[e.jsx(pe,{style:be,collapsible:!0,collapsed:H,onCollapse:M=>K(M),children:e.jsx(fe,{mode:"inline",theme:"dark",textitem:o[d].item,routers:k})}),e.jsxs(W,{children:[e.jsx(he,{style:{backgroundColor:"#409eff"},children:e.jsxs(E,{style:{height:"100%"},children:[e.jsx(I,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ge,{})}),e.jsx(I,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"退出"})})]})}),e.jsx(xe,{style:ye,children:e.jsxs(de,{children:[e.jsx(B,{path:"/home/welcome",element:e.jsx(je,{job:o[d].name,usermsg:p})}),e.jsx(B,{path:"/home/paylist",element:e.jsx(Nt,{tableitems:y,getOutPay:F,tabletype:"bed",columns:g,tabledata:c,tablepage:f,tabletitle:A})}),e.jsx(B,{path:"/home/collectmsg",element:e.jsx(Et,{lognum:d,userid:T})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/home/welcome"})})]})})]})]})});if(d===5)return e.jsx(te,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(W,{style:{minHeight:"100vh"},children:[e.jsx(pe,{style:be,collapsible:!0,collapsed:H,onCollapse:M=>K(M),children:e.jsx(fe,{mode:"inline",theme:"dark",textitem:o[d].item,routers:k})}),e.jsxs(W,{children:[e.jsx(he,{style:{backgroundColor:"#409eff"},children:e.jsxs(E,{style:{height:"100%"},children:[e.jsx(I,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ge,{})}),e.jsx(I,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"退出"})})]})}),e.jsx(xe,{style:ye,children:e.jsxs(de,{children:[e.jsx(B,{path:"/home/welcome",element:e.jsx(je,{job:o[d].name,usermsg:p})}),e.jsx(B,{path:"/home/checkin",element:e.jsx(Be,{lognum:d})}),e.jsx(B,{path:"/home/face",element:e.jsx(qt,{})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/home/welcome"})})]})})]})]})});if(d===6)return e.jsx(te,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(W,{style:{minHeight:"100vh"},children:[e.jsx(pe,{style:be,collapsible:!0,collapsed:H,onCollapse:M=>K(M),children:e.jsx(fe,{mode:"inline",theme:"dark",textitem:o[d].item,routers:k})}),e.jsxs(W,{children:[e.jsx(he,{style:{backgroundColor:"#409eff"},children:e.jsxs(E,{style:{height:"100%"},children:[e.jsx(I,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ge,{})}),e.jsx(I,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"退出"})})]})}),e.jsx(xe,{style:ye,children:e.jsxs(de,{children:[e.jsx(B,{path:"/home/welcome",element:e.jsx(je,{job:o[d].name,usermsg:p})}),e.jsx(B,{path:"/home/checkin",element:e.jsx(Be,{lognum:d})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/home/welcome"})})]})})]})]})});if(d===7)return e.jsx(te,{direction:"vertical",style:{width:"100%"},size:[0,48],children:e.jsxs(W,{style:{minHeight:"100vh"},children:[e.jsx(pe,{style:be,collapsible:!0,collapsed:H,onCollapse:M=>K(M),children:e.jsx(fe,{mode:"inline",theme:"dark",textitem:o[d].item,routers:k})}),e.jsxs(W,{children:[e.jsx(he,{style:{backgroundColor:"#409eff"},children:e.jsxs(E,{style:{height:"100%"},children:[e.jsx(I,{span:12,style:{display:"flex",justifyContent:"start",alignItems:"center"},children:e.jsx(ge,{})}),e.jsx(I,{span:12,style:{display:"flex",justifyContent:"end",alignItems:"center"},children:e.jsx(U,{onClick:z,children:"退出"})})]})}),e.jsx(xe,{style:ye,children:e.jsxs(de,{children:[e.jsx(B,{path:"/home/welcome",element:e.jsx(je,{job:o[d].name,usermsg:p})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/home/welcome"})})]})})]})]})})}function Qt(s){const{apartUpdate:u,roomUpdate:x,bedUpdate:y}=s,{type:n,title:j,placement:w,onClose:v,open:a,tableitems:S,records:F}=s,[d,T]=r.useState(!1),[o,p]=r.useState(0),[g,c]=r.useState({status:0});function f(){T(!0),u(F.index,g),T(!1)}function A(K){c(z=>(z.status=K.target.value,z)),p(K.target.value)}function k(){T(!0),x(F.index),T(!1)}function H(){T(!0),y(F.index),T(!1)}if(S.length===0)return e.jsx(Ie,{title:j,placement:w,onClose:v,open:a,children:e.jsx(Ee,{})});if(n==="apart")return e.jsxs(Ie,{title:j,placement:w,onClose:v,open:a,children:[S,"此公寓",e.jsxs(Ae.Group,{onChange:A,value:o,children:[e.jsx(Ae,{value:0,children:"正常使用"}),e.jsx(Ae,{value:1,children:"启用中"}),e.jsx(Ae,{value:2,children:"弃用中"}),e.jsx(Ae,{value:3,children:"已弃用"})]}),e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(U,{type:"primary",loading:d,onClick:f,children:"修改"})})]});if(n==="room")return e.jsxs(Ie,{title:j,placement:w,onClose:v,open:a,children:[S,e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(U,{type:"primary",loading:d,onClick:k,children:"修改"})})]});if(n==="bed")return e.jsxs(Ie,{title:j,placement:w,onClose:v,open:a,children:[S,e.jsx("br",{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(U,{type:"primary",loading:d,onClick:H,children:"修改"})})]})}function _(s,u,x,y,n){return{key:u,icon:x,children:y,label:s,type:n}}const _t=[{},{id:1,name:"超级管理员",item:[_("管理员账号管理","1",e.jsx(_e,{})),_("外部单位管理","2",e.jsx(vt,{})),_("公寓管理","3",e.jsx(Ke,{})),_("房间管理","4",e.jsx(tt,{}))]},{id:2,name:"入住办理员",item:[_("住宿申请审核","1",e.jsx(Le,{})),_("床位编号录入","2",e.jsx(nt,{})),_("人脸录入确认","3",e.jsx(st,{}))],routers:[{route:"/checkin"},{route:"/bedid"},{route:"/face"}]},{id:3,name:"宿舍调配员",item:[_("宿舍分配","1",e.jsx(Le,{})),_("公寓管理","2",e.jsx(Ke,{})),_("房间管理","3",e.jsx(tt,{})),_("床位管理","4",e.jsx(nt,{}))],routers:[{route:"/promise"},{route:"/apart"},{route:"/room"},{route:"/bed"}],addmessages:{apart:"name为公寓名 position为公寓地址 location为经纬度地址",room:"name为宿舍号 sex为性别，应填写“男”或“女” usage为宿舍用途 type为房间种类，应填写“n人间”，n为整数 isForCadre为干部房标识，应填写“是”或“否” isReserved代表此房间是否保留，应填写“是”或“否” totalFee为宿舍费用 selfPayFee为自费费用 refundFee为单位报销费用 ",bed:"name为床位名 roomId为床位所在的宿舍号 receiptId为押金收据单号 isInUse代表床位是否已被占用，应填写“是”或“否” "}},{id:4,name:"财务管理员",item:[_("缴费统计表","1",e.jsx(Tt,{})),_("催收信","2",e.jsx(Ut,{})),_("宿舍情况查询","3",e.jsx(Ke,{}))],routers:[{route:"/paylist"},{route:"/collectmsg"},{route:"/roomchexk"}]},{id:5,name:"宿舍管理班组",item:[_("待办申请","1",e.jsx(Le,{})),_("人脸识别","2",e.jsx(st,{}))],routers:[{route:"/checkin"},{route:"/face"}]},{id:6,name:"外部单位入住办理员",item:[_("入住申请审核","1",e.jsx(Le,{}))],routers:[{route:"/checkin"}]}];function Vt(){const[s,u]=r.useState(!1),[x,y]=r.useState(0),[n,j]=r.useState(null),[w,v]=r.useState(""),[a,S]=r.useState([]),[F,d]=r.useState([]),[T,o]=r.useState(0),[p,g]=r.useState(""),[c,f]=r.useState(!1),[A,k]=r.useState(""),[H,K]=r.useState({}),[z,M]=r.useState([]),[Z,Oe]=r.useState([]),[C,ee]=r.useState({}),[ve,V]=r.useState([]),[Me,re]=r.useState(""),[Ne,Je]=r.useState(null),[Xe,we]=r.useState(!1),[R,oe]=ke.useMessage();Ve(),r.useEffect(()=>{Se.defaults.baseURL="https://apartment-server.wangminan.me",Se.get("/api/auth/hello")},[]);const ie=[{title:"Name",dataIndex:"name",key:"name"},{title:"Position",dataIndex:"position",key:"position"},{title:"Location",dataIndex:"location",key:"location"},{title:"Action",key:"action",render:(l,t,m)=>e.jsxs(te,{size:"middle",children:[e.jsx(U,{type:"primary",onClick:()=>Te(m,t,"apart"),children:"修改此条目"}),e.jsxs(U,{type:"primary",onClick:()=>He(m),children:["删除",t.name]})]})}];function me(l){M(()=>{let t=[];for(let m=0;m<l.length-1;m++)t.push(l[m].dataIndex);return t}),M(t=>t)}function Fe(l){ee(()=>(C[l.target.id]=l.target.value,C))}function Te(l,t,m){re(()=>m),K(t),f(!0),k(()=>"修改第"+(l+1)+"条"),M(O=>(K(P=>(Oe(()=>{let b=[];for(let X=0;X<O.length;X++)b.push(e.jsxs("div",{children:[e.jsx("p",{children:O[X]}),e.jsx(ae,{id:O[X],onChange:Fe,defaultValue:P[O[X]]})]},se())),ee(Y=>(Y[O[X]]=P[O[X]],Y));return b}),P)),O))}function q(l){ee(t=>(t[l.target.id]=l.target.value,t))}function G(l){re(()=>l),k(()=>"新增"+l+"条目"),M(t=>(K(m=>(Oe(()=>{let O=[];for(let P=0;P<t.length;P++)t[P]==="receiptId"||t[P]==="isInUse"||(t[P]==="location"?O.push(e.jsxs("div",{children:[e.jsx("p",{children:t[P]}),e.jsx(ae,{id:t[P],onChange:q,defaultValue:"请输入合法经纬度,以英文逗号分隔"})]},se())):O.push(e.jsxs("div",{children:[e.jsx("p",{children:t[P]}),e.jsx(ae,{id:t[P],onChange:q,defaultValue:""})]},se())));return O}),m)),t))}function J(){let l=[];return ee(t=>(l=t.location.split(","),l.length!=2?(R.info("Location格式不正确！"),!1):(t.lon0=l[0],t.lon1=l[1],t))),!0}function Ce(){J(),D({method:"POST",url:"/api/management/apartment",data:{foremanAdminId:x,name:C.name,position:C.position,positionLongitude:C.lon1,positionLatitude:C.lon0,status:0}}).then(l=>{const{code:t}=l.data;if(t===2e3)N(1,100),R.info("增加已完成,请刷新页面以查看最新结果");else{const{msg:m}=l.data;R.info(m)}})}function ze(l,t){J(),V(m=>(D({method:"PUT",url:`/api/management/apartment/${m[l]}`,data:{foremanAdminId:x,name:C.name,position:C.position,positionLongitude:C.lon1,positionLatitude:C.lon0,status:t.status}}).then(O=>{const{code:P}=O.data;if(P===2e3)N(1,100),R.info("修改已完成，请刷新以查看修改结果"),f(!1);else{const{msg:b}=O.data;R.info(b),f(!1)}}),m))}function He(l){V(t=>{D({method:"DELETE",url:`/api/management/apartment/${t[l]}`}).then(m=>{const{code:O}=m.data;if(O===2e3)N(1,100),R.info("删除已完成,请刷新页面以查看最新结果");else{const{msg:P}=m.data;R.info(P)}})})}function N(l,t){D({method:"GET",url:`/api/management/apartment?pageNum=${l}&pageSize=${t}`}).then(m=>{const{code:O,msg:P}=m.data,{list:b,total:X}=m.data.result;if(O===2e3){g("公寓列表"),o(Math.ceil(X/t)),S(ie),me(ie),V(i=>(i=[],i));let Y=[];for(let i=0;i<b.length;i++){V(ne=>(ne.push(b[i].id),ne));let h={};h.key=se(),h.index=i,h.name=b[i].name,h.position=b[i].position,h.location=b[i].location,Y.push(h)}d(Y),we(()=>(ue.publish("tablereturned",!0),!0))}else R.info(P)})}const Ue=[{title:"宿舍号",dataIndex:"name",key:"name"},{title:"性别",dataIndex:"sex",key:"sex"},{title:"用途",dataIndex:"usage",key:"usage"},{title:"房间规格",dataIndex:"type",key:"type"},{title:"干部房",dataIndex:"isForCadre",key:"isForCadre"},{title:"保留间",dataIndex:"isReserved",key:"isReserved"},{title:"房间总价",dataIndex:"totalFee",key:"totalFee"},{title:"自理部分",dataIndex:"selfPayFee",key:"selfPayFee"},{title:"单位报销",dataIndex:"refundFee",key:"refundFee"},{title:"Action",key:"action",render:(l,t,m)=>e.jsxs(te,{size:"middle",children:[e.jsx(U,{type:"primary",onClick:()=>Te(m,t,"room"),children:"修改此条目"}),e.jsxs(U,{type:"primary",onClick:()=>ot(m),children:["删除",t.name]})]})}];function $(){let l=!0;return ee(t=>(t.sex==="man"||t.sex==="男"?t.sex=0:t.sex==="woman"||t.sex==="女"?t.sex=1:(R.info("性别格式非法"),l=!1),t.isForCadre==="是"?t.isForCadre=1:t.isForCadre==="否"?t.isForCadre=0:(R.info("干部房状态格式非法"),l=!1),t.isReserved==="是"?t.isReserved=1:t.isReserved==="否"?t.isReserved=0:(R.info("保留间状态格式非法"),l=!1),t.type==="单人间"?t.type=1:t.type==="双人间"?t.type=2:t.type=parseInt(t.type.substring(0,t.type.indexOf("人"))),parseInt(t.totalFee)!==parseInt(t.selfPayFee)+parseInt(t.refundFee)&&(R.info("总价不等于单位报销部分和个人自理部分之和"),console.log("总"+t.totalFee+"B"+t.refundFee+"S"+t.selfPayFee),l=!1),t)),l}function Q(){$()&&D({method:"POST",url:"/api/management/room",data:{apartmentId:1,name:C.name,sex:C.sex,usage:C.usage,isForCadre:C.isForCadre,isReserved:C.isReserved,type:C.type,totalFee:C.totalFee,selfPayFee:C.selfPayFee,refundFee:C.refundFee}}).then(l=>{const{code:t}=l.data;if(t===2e3)Re(1,100),R.info("增加已完成,请刷新页面以查看最新结果");else{const{msg:m}=l.data;R.info(m)}})}function rt(l){$()&&V(t=>(D({method:"PUT",url:`/api/management/room/${t[l]}`,data:{apartmentId:1,name:C.name,sex:C.sex,usage:C.usage,isForCadre:C.isForCadre,isReserved:C.isReserved,type:C.type,totalFee:C.totalFee,selfPayFee:C.selfPayFee,refundFee:C.refundFee}}).then(m=>{const{code:O}=m.data;if(O===2e3)Re(1,100),R.info("修改已完成，请刷新以查看修改结果"),f(!1);else{const{msg:P}=m.data;R.info(P),f(!1)}}),t))}function ot(l){V(t=>{D({method:"DELETE",url:`/api/management/room/${t[l]}`}).then(m=>{const{code:O}=m.data;if(O===2e3)Re(1,100),R.info("删除已完成,请刷新页面以查看最新结果");else{const{msg:P}=m.data;R.info(P)}})})}function Re(l,t){D.get("/api/management/room",{params:{pageNum:l,pageSize:t,apartmentId:1,query:"",isForCadre:"",type:""}}).then(m=>{const{code:O,msg:P}=m.data,{list:b,total:X}=m.data.result;if(O===2e3){g("房间列表"),o(Math.ceil(X/t)),o(i=>(ue.publish("tablepage",i),i)),S(Ue),me(Ue),V(i=>(i=[],i));let Y=[];for(let i=0;i<b.length;i++){V(ne=>(ne.push(b[i].id),ne));let h={};h.key=se(),h.index=i,h.name=b[i].name,b[i].sex===0?h.sex="man":b[i].sex===1&&(h.sex="woman"),h.usage=b[i].usage,b[i].type===1?h.type="单人间":b[i].type===2?h.type="双人间":h.type=b[i].type+"人间",b[i].isForCadre?h.isForCadre="是":h.isForCadre="否",b[i].isReserved?h.isReserved="是":h.isReserved="否",h.totalFee=b[i].totalFee,h.selfPayFee=b[i].selfPayFee,h.refundFee=b[i].refundFee,Y.push(h)}d(Y),we(()=>(ue.publish("tablereturned",!0),!0))}else R.info(P)})}const Ye=[{title:"床位ID",dataIndex:"id",key:"id"},{title:"床位名",dataIndex:"name",key:"name"},{title:"所属房间的id",dataIndex:"roomId",key:"roomId"},{title:"押金收据单号",dataIndex:"receiptId",key:"receiptId"},{title:"床位使用情况",dataIndex:"isInUse",key:"isInUse"},{title:"Action",key:"action",render:(l,t,m)=>e.jsxs(te,{size:"middle",children:[e.jsx(U,{type:"primary",onClick:()=>Te(m,t,"bed"),children:"修改此条目"}),e.jsxs(U,{type:"primary",onClick:()=>ut(m),children:["删除",t.name]})]})}];function lt(){let l=!0;return ee(t=>(t.isInUse==="是"?t.isInUse=1:t.isInUse==="否"?t.isInUse=0:(R.info("床位使用情况格式非法"),l=!1),t)),l}function dt(){D({method:"POST",url:"/api/management/bed",data:{name:C.name,roomId:C.roomId}}).then(l=>{const{code:t}=l.data;if(t===2e3)De(1,100),R.info("增加已完成,请刷新页面以查看最新结果");else{const{msg:m}=l.data;R.info(m)}})}function ct(l){lt()&&V(t=>(D({method:"PUT",url:`/api/management/bed/${t[l]}`,data:{name:C.name,roomId:C.roomId,receiptId:C.receiptId,isInUse:C.isInUse}}).then(m=>{const{code:O}=m.data;if(O===2e3)De(1,100),R.info("修改已完成，请刷新以查看修改结果"),f(!1);else{const{msg:P}=m.data;R.info(P),f(!1)}}),t))}function ut(l){V(t=>{D({method:"DELETE",url:`/api/management/bed/${t[l]}`}).then(m=>{const{code:O}=m.data;if(O===2e3)De(1,100),R.info("删除已完成,请刷新页面以查看最新结果");else{const{msg:P}=m.data;R.info(P)}})})}function De(l,t){D.get("/api/management/bed",{params:{pageNum:l,pageSize:t,apartmentId:"",query:"",roomId:"",isInUse:""}}).then(m=>{const{code:O,msg:P}=m.data,{list:b,total:X}=m.data.result;if(O===2e3){g("床位列表"),o(Math.ceil(X/t)),o(i=>(ue.publish("tablepage",i),i)),S(Ye),me(Ye),V(i=>(i=[],i));let Y=[];for(let i=0;i<b.length;i++){V(ne=>(ne.push(b[i].id),ne));let h={};h.key=se(),h.index=i,h.id=b[i].id,h.name=b[i].name,h.roomId=b[i].roomId,h.receiptId=b[i].receiptId,b[i].isInUse===1?h.isInUse="是":h.isInUse="否",Y.push(h)}d(Y),we(()=>(ue.publish("tablereturned",!0),!0))}else R.info(P)})}const We=[{title:"支票ID",dataIndex:"chequeId",key:"chequeId"},{title:"公寓ID",dataIndex:"departmentId",key:"departmentId"},{title:"是否已支付",dataIndex:"hasPaid",key:"hasPaid"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"支付时间",dataIndex:"payTime",key:"payTime"},{title:"金额",dataIndex:"price",key:"price"}];function mt(l,t){D.get("/api/finance/center/withhold",{params:{pageNum:l,pageSize:t}}).then(m=>{const{code:O,msg:P}=m.data,{list:b,total:X}=m.data.result;if(O===2e3){g("外部单位代扣表"),S(We),me(We),V(i=>(i=[],i));let Y=[];for(let i=0;i<b.length;i++){V(ne=>(ne.push(b[i].id),ne));let h={};h.key=se(),h.index=i,h.id=b[i].id,h.chequeId=b[i].chequeId,h.departmentId=b[i].departmentId,b[i].hasPaid===1?h.hasPaid="是":h.hasPaid="否",h.createTime=b[i].createTime,h.payTime=b[i].payTime,h.price=b[i].price,Y.push(h)}d(Y),we(()=>(ue.publish("tablereturned",!0),!0))}else R.info(P)})}function pt(l,t){u(m=>!0),y(l),v(t.id),j(t.name)}function ht(){window.localStorage.removeItem("token"),u(!1)}return s?e.jsxs("div",{children:[oe,e.jsx(Gt,{lognum:x,userid:w,usermsg:n,textitem:_t,columns:a,tabledata:F,tablepage:T,tabletitle:p,logOut:ht,getApart:N,getRoom:Re,getBed:De,getOutPay:mt,openAddDrawer:G,addButtons:Ne,tableitems:Z,apartAdd:Ce,roomAdd:Q,bedAdd:dt}),e.jsx(Qt,{type:Me,title:A,placement:"bottom",onClose:()=>f(!1),open:c,tableitems:Z,records:H,apartUpdate:ze,roomUpdate:rt,bedUpdate:ct})]}):e.jsx("div",{className:"login-box",children:e.jsx("div",{className:"glass",style:{borderRadius:"10px"},children:e.jsxs("div",{className:"innerlogin",children:[e.jsx("p",{style:{color:"white",fontSize:"35px"},children:e.jsx("b",{children:"杭房段员工公寓管理系统"})}),e.jsx("img",{alt:"员工公寓管理系统",src:Dt}),e.jsxs(de,{children:[e.jsx(B,{path:"/login",element:e.jsx(Ft,{login:pt})}),e.jsx(B,{path:"/register",element:e.jsx(Rt,{})}),e.jsx(B,{path:"*",element:e.jsx(ce,{to:"/login"})})]})]})})})}const qe="user_key",Jt={saveUser(s){$e.set(qe,s)},getUser(){return $e.get(qe)||{}},removeUser(){$e.remove(qe)}};Jt.getUser();xt.createRoot(document.getElementById("root")).render(e.jsx(ft,{children:e.jsx(Vt,{})}));
